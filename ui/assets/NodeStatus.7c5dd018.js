import{A as e}from"./api_clusterManage.8c154fe5.js";import"./vendor.194c4086.js";import{n as t}from"./index.8e63218a.js";import"./index.dfdb83b1.js";import"./bus.d56574c1.js";const n={};var a=t({data:()=>({loading:!1,paginationInfo:{currentPage:1,size:10,total:0},filters:{inquires:""},connectPoolStateList:[],tableInfo:[{name:"zqpool_id",cname:"ZQPoolID"},{name:"pool_id",cname:"PoolID"},{name:"pool_fe",cname:"PoolFe"},{name:"cluster_id",cname:"ClusterID"},{name:"db_id",cname:"DBID"},{name:"host",cname:"Host"},{name:"port",cname:"Port"},{name:"state",cname:"State",state_options:{1:"Online",0:"Offline","-1":"BadNoFree","-2":"BadFreed","-3":"Unknow","-9":"Removing",null:"Unknow"}},{name:"RwState",cname:"RwState"}],margeObj:{},margeArr:["zqpool_id","pool_id"],currentCommon:-1}),methods:{search(){this.$refs.pagination.$emit("current-change",1),this.getInfo()},sizeChange(e){this.paginationInfo.size=e,this.getInfo()},currentChange(e){this.paginationInfo.currentPage=e,this.getInfo()},getInfo(){let t={page_size:this.paginationInfo.size,page_num:this.paginationInfo.currentPage,filter:this.filters.inquires};this.loading=!0,e.getPortalsList(t).then((e=>{this.paginationInfo.total=e.total,this.connectPoolStateList=e.rows,this.findMargeDataInfo(this.connectPoolStateList),this.loading=!1}),(e=>{this.loading=!1}))},findMargeDataInfo(e){this.margeArr.forEach(((t,n)=>{let a=0;this.margeObj[t]=[],e.forEach(((n,o)=>{if(0===o)this.margeObj[t].push(1);else{n[t]===e[o-1][t]?(this.margeObj[t][a]+=1,this.margeObj[t].push(0)):(a=o,this.margeObj[t].push(1))}}))}))},arraySpanMethod({row:e,column:t,rowIndex:n,columnIndex:a}){if(this.margeArr.includes(t.property)){let e=this.margeObj[t.property][n];return e?[e,1]:[0,0]}},rowClassName({row:e}){return e.zqpool_id===this.currentCommon?"my-hover-row":""},cellMouseEnter(e,t,n,a){this.currentCommon=e.zqpool_id},cellMouseLeave(){this.currentCommon=-1}},mounted(){this.getInfo()}},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{staticClass:"filterForm",attrs:{model:e.filters},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",[n("el-input",{attrs:{placeholder:this.$t("ConnectionPoolManagement.qingshuru-search-two")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filters.inquires,callback:function(t){e.$set(e.filters,"inquires",t)},expression:"filters.inquires"}},[n("el-button",{attrs:{slot:"append",type:"primary"},on:{click:e.search},slot:"append"},[e._v(e._s(e.$t("dbList.shou-suo")))])],1)],1),n("el-form-item",{staticStyle:{flex:"1","text-align":"right",color:"red"}},[n("el-button",{staticClass:"normal el-icon-refresh-right",on:{click:e.getInfo}},[e._v(" "+e._s(e.$t("resourceManagement.shua-xin")))])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"row-class-name":e.rowClassName,"span-method":e.arraySpanMethod,data:e.connectPoolStateList,border:"","element-loading-text":e.$t("Public.ping-ming-jia-zai-zhong")},on:{"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave}},e._l(e.tableInfo,(function(t){return n("el-table-column",{key:t.name,attrs:{"min-width":t.width?t.width:"50px",prop:t.name,label:t.cname,align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var o=a.row;return["state"===t.name?n("div",[n("i",{class:[1===o.state?"el-icon-success green":0===o.state?"el-icon-success":"el-icon-error red"]},[n("span",[e._v(e._s(t.state_options[String(o[t.name])]))])])]):n("div",[n("span",[e._v(e._s(o[t.name]))])])]}}],null,!0)})})),1),n("div",{staticClass:"block clearfix"},[n("div",{staticClass:"fr"},[n("el-pagination",{ref:"pagination",attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.paginationInfo.size,"current-page":e.paginationInfo.currentPage,total:e.paginationInfo.total,"page-sizes":[10,20,30,40,50]},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)])],1)}),[],!1,o,"5ed86d1f",null,null);function o(e){for(let t in n)this[t]=n[t]}var i=function(){return a.exports}();export{i as default};
