import{A as e}from"./api_clusterManage.8c154fe5.js";import{a as t,s as o}from"./staticTools.84335405.js";import{n as i}from"./index.8e63218a.js";import"./index.dfdb83b1.js";import"./vendor.194c4086.js";import"./bus.d56574c1.js";const n={};var a=i({data:()=>({ViewLogConetentVisible:!1,logSize:"2KB",logLevel:"",savLevel:"",rows:{},formInfo:{},filePaginationInfo:{currentPage:1,size:1,total:0},fileLogArray:[]}),props:["is-show","data-rows"],methods:{setLogLevel(i){let n={zqpool_id:this.rows.zqpool_id,log_level:i};const a=t(".ViewLogConetentDialog .el-dialog");e.setZqpoolLogLevel(n).then((e=>{o(this.$t("ConnectionPoolManagement.shezhi-chenggong-level",[i])),this.savLevel=i,a.close()}),(e=>{this.logLevel=this.savLevel,a.close()}))},selectSize(){this.$refs.filePagination.$emit("current-change",1)},fileCurrentChange(e){this.filePaginationInfo.currentPage=e,this.getinfo()},getinfo(){let o={zqpool_id:this.rows.zqpool_id,page_num:this.filePaginationInfo.currentPage,read_size:Number(this.formatSelectSize(this.logSize))};const i=t(".ViewLogConetentDialog .el-dialog");e.getZqpoolLogContent(o).then((e=>{this.filePaginationInfo.total=e.page_count,this.fileLogArray=e.content.split("\n"),this.$nextTick((()=>{document.querySelector(".ViewLogConetentDialog .file-footer .el-pagination__total").innerHTML=this.$t("viewDatabaseLogs.gong-number-ye",[this.filePaginationInfo.total])})),i.close()}),(e=>{i.close()}))},getZqpoolLogLevel(){const t={zqpool_id:this.rows.zqpool_id};e.getZqpoolLogLevel(t).then((e=>{this.logLevel=e.log_level,this.savLevel=e.log_level}))},closeDialog(){this.ViewLogConetentVisible=!1,this.$emit("update:isShow",this.ViewLogConetentVisible)},formatSelectSize(e){if(!e)return 0;const t=e.match(/([\d.]+)\s*([a-zA-Z]+)/);if(t){const i=parseFloat(t[1]),n=t[2],a=1024;let l=["B","KB","MB","GB","TB","PB"].findIndex((e=>e===n));if(-1===l)return o(this.$t("ConnectionPoolManagement.qingjiaca-chuanru-m"),"warning"),e;return i*Math.pow(a,l)}return o(this.$t("ConnectionPoolManagement.qingjiaca-chuanru-m"),"warning"),e}},created(){this.ViewLogConetentVisible=this.$props.isShow,this.rows=this.$props.dataRows},mounted(){this.getinfo(),this.getZqpoolLogLevel()}},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{staticClass:"ViewLogConetentDialog",attrs:{"append-to-body":!0,title:e.$t("taskLog.rizhi-xinxi")+"  ZQPoolIDï¼š"+e.rows.zqpool_id,visible:e.ViewLogConetentVisible,"close-on-click-modal":!1,top:"5vh"},on:{close:e.closeDialog,"update:visible":function(t){e.ViewLogConetentVisible=t}}},[o("div",{staticClass:"file-body"},[o("section",{staticClass:"radio-group"},[o("div",[o("span",[e._v(e._s(e.$t("ConnectionPoolManagement.shezhirizhi-jibie")))]),o("el-radio-group",{staticClass:"radio-group-left",attrs:{size:"mini"},on:{input:e.setLogLevel},model:{value:e.logLevel,callback:function(t){e.logLevel=t},expression:"logLevel"}},[o("el-radio-button",{attrs:{label:"info"}},[e._v("INFO")]),o("el-radio-button",{staticClass:"warn",attrs:{label:"warn"}},[e._v("WARN")]),o("el-radio-button",{staticClass:"error",attrs:{label:"error"}},[e._v("ERROR")])],1)],1),o("el-radio-group",{staticClass:"radio-group-right",attrs:{size:"mini"},on:{input:e.selectSize},model:{value:e.logSize,callback:function(t){e.logSize=t},expression:"logSize"}},[o("el-radio-button",{attrs:{label:"2KB"}}),o("el-radio-button",{attrs:{label:"4KB"}}),o("el-radio-button",{attrs:{label:"1MB"}}),o("el-radio-button",{attrs:{label:"2MB"}})],1)],1),o("el-card",{staticClass:"file-card",attrs:{shadow:"never","body-style":"border: none !important;"}},[o("div",{staticStyle:{"overflow-y":"auto"}},e._l(e.fileLogArray,(function(t,i){return o("p",{key:i,staticStyle:{"font-size":"14px"}},[e._v(e._s(t))])})),0)]),o("div",{staticClass:"file-footer"},[o("el-pagination",{ref:"filePagination",attrs:{layout:"total, prev, pager, next, jumper","page-size":e.filePaginationInfo.size,"current-page":e.filePaginationInfo.currentPage,total:e.filePaginationInfo.total,"page-sizes":[10,20,30,40,50]},on:{"current-change":e.fileCurrentChange}})],1)],1)])}),[],!1,l,"c7ad21ce",null,null);function l(e){for(let t in n)this[t]=n[t]}var s=function(){return a.exports}();export{s as default};
