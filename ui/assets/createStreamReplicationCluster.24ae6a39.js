import{A as e}from"./api_clusterManage.788b7961.js";import{n as t,D as r}from"./index.851f4377.js";import{b as a,e as s,f as i,g as l}from"./verificationRules.43272891.js";import{s as o,a as n,f as c,g as u,b as m}from"./staticTools.84335405.js";import"./index.dfdb83b1.js";import"./vendor.194c4086.js";import"./bus.d56574c1.js";const p={};var g=t({name:"clusterDefine",data(){let t=(e,t,r)=>{const a=this;return t?(a.createSrClusterInfoForm.db_user==a.createSrClusterInfoForm.repl_user?(a.ischeckpass=!0,a.createSrClusterInfoForm.repl_pass=a.createSrClusterInfoForm.db_pass):a.ischeckpass=!1,r()):r()};return{byteUnitDict:{B:"",kB:"kB",MB:"MB",GB:"GB",TB:"TB"},timeUnitDict:{ms:"ms",s:"s",min:"min",h:"h",d:"d"},loading:!1,loading_pgdata:!1,loading_port:!1,os_uid_disabled:!0,loading_os_user:!1,loading_pg_bin_path_list:!1,pg_bin_path_list:[],loading_version:!1,createSrClusterFormVisible:!1,ischeckpass:!1,createSrClusterInfoFormRules:{cluster_name:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-jiqun-mingcheng"),trigger:"blur"}],pool_id:[{required:!0,message:this.$t("computerRoomConfig.qingxuanze-vip-chi-id"),trigger:"change"}],vip:[{required:!0,message:this.$t("polarDbComputerRoomConfig.qingshuru-VIP"),trigger:"change"},{required:!0,validator:(e,t,r)=>{let a=this;if(t){let e=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,s=t.split(",");for(let t in s)if(!1===e.test(s[t]))return r(new Error(this.$t("createStandbyPage.IP-dizhi-buguifan-message")));return null!=a.ClusterDbRows.find((e=>e.repl_ip===t))?r(new Error(this.$t("createStreamReplicationCluster.IPdizhi-chongfu-message"))):r()}return r(new Error(this.$t("createStandbyPage.qingshuru-IP-dizhi")))},trigger:"blur"},{required:!0,validator:(t,r,a)=>{if(""===r)a(new Error(this.$t("computerRoomConfig.qingxuanze-vip-chi-id")));else{let t={pool_id:this.createSrClusterInfoForm.pool_id,vip:this.createSrClusterInfoForm.vip};e.checkVipInPool(t).then((e=>{a()}))}},trigger:"blur"}],port:[{required:!0,validator:a,trigger:"blur"},{required:!0,validator:(t,r,a)=>{if(""==this.createSrClusterInfoForm.port)return a();this.loading_port=!0;let s=[];for(let e=0;e<this.ClusterDbRows.length;e++){let t={host:this.ClusterDbRows[e].host,port:r};s.push(t)}Promise.all(s.map((t=>e.checkPortIsUsed(t)))).then((e=>{console.log(e),this.loading_port=!1,e.forEach(((t,r)=>0!=t.err_code?a(new Error(e.err_msg)):0==t.is_used&&r==e.length-1?a():1==t.is_used?a(new Error(this.$t("verificationRules.gaiduankou-yibei-m"))):void 0))}),(e=>(this.loading_port=!1,a(new Error(this.$t("verificationRules.jiancha-qingqiu-chucuo"))))))},trigger:"submit"}],pgdata:[{required:!0,message:this.$t("defineDatabasePage.qingshuru-shuju-mulu"),trigger:"blur"}],db_user:[{required:!0,validator:t,message:this.$t("createDatabasePage.HA-guanli-yonghu-message"),trigger:"blur"}],db_pass:[{required:!0,validator:t,message:this.$t("defineDatabasePage.DB-zhongde-mima-placeholder"),trigger:"blur"}],repl_user:[{required:!0,validator:t,message:this.$t("createStreamReplicationCluster.qingshuru-liufuzhi-yonghu"),trigger:"blur"}],repl_pass:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-liufuzhi-yonghude-mima"),trigger:"blur"}],db_ip_list:[{required:!0,validator:s,trigger:"blur"}],repl_ip_list:[{required:!0,validator:s,trigger:"blur"}],probe_db_name:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-DB"),trigger:"blur"}],probe_interval:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-zhouqi-miao"),trigger:"blur"}],probe_timeout:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-chaoshi-miao"),trigger:"blur"}],probe_retry_cnt:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tanceshibai-message"),trigger:"blur"}],probe_retry_interval:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-shibaihou-message"),trigger:"blur"}],probe_pri_sql:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-zhuku-SQL"),trigger:"blur"}],probe_stb_sql:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-beiku-SQL"),trigger:"blur"}]},mostCommonlyUsedRow:[],commonlyUsedRow:[],commonlyRow:[],createSrClusterInfoForm:{},createSrClusterDbForm:{scores:0,repl_ip:"",pgdata:""},createSrClusterDbFormRules:{host:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-zhuji"),trigger:["blur","submit"]}],pg_bin_path:[{required:!0,message:this.$t("createDatabasePage.bixu-xuanze-youxiao-raunjianmulu"),trigger:["blur","submit"]}],os_user:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-caozuo-xitong-yonghu"),trigger:"blur"}],os_uid:[{required:!0,message:this.$t("qingshur-yonghu-UID"),trigger:"blur"},{type:"number",message:this.$t("createDatabasePage.qingshuru-shuzi"),trigger:"blur"}],sync:[{required:!0,trigger:"change"}],repl_ip:[{required:!0,validator:s,trigger:"blur"}],pgdata:[{required:!0,message:this.$t("defineDatabasePage.qingshuru-shuju-mulu"),trigger:"blur"},{required:!0,validator:(t,r,a)=>{if(""===r)a(new Error(this.$t("verificationRules.qingshuru-shuji-mulu")));else{if(!this.createSrClusterDbForm.host)return a(this.$t("createDatabasePage.xuanzezhuji-kechakan-message"));{let t={host:this.createSrClusterDbForm.host,pgdata:r};this.loading_pgdata=!0,e.checkTheDirIsEmpty(t).then((e=>(this.loading_pgdata=!1,1==e.is_empty?a():0==e.is_empty?a(new Error(this.$t("verificationRules.gaishuju-mulu-m"))):a(new Error(e.err_msg)))),(e=>(this.loading_pgdata=!1,a(new Error(this.$t("verificationRules.jiancha-qingqiu-chucuo"))))))}}},trigger:"submit"}],conn_cnt:[{required:!0,validator:(e,t,r)=>{if(t)return t<20||t>1e4?r(new Error(this.$t("createDatabasePage.lianjie-fanwewi"))):r();r(new Error(this.$t("createDatabasePage.qingshuru-lianjieshu")))},trigger:"blur"},{type:"number",message:this.$t("createDatabasePage.lianjieshu-bixuwei-shuzizhi")}],mem_size:[{required:!0,message:this.$t("createDatabasePage.qingshuru-neicun-daxiao"),trigger:"blur"},{type:"number",message:this.$t("createDatabasePage.neicun-bixuei-shuzizhi")}],scores:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-shujukude-youxianji"),trigger:"blur"},{type:"number",message:this.$t("createStreamReplicationCluster.youxianji-bixuwei-shuzi")}],storage_size:[{required:!0,message:this.$t("createDatabasePage.qingxuanze-cunchu-guige"),trigger:"change"}],wal_segsize:[{required:!0,message:this.$t("createPolardbCluster.qingxuanze-wal-wenjian-daxiao"),trigger:"change"}]},createSrClusterProbeForm:{},createSrClusterProbeFormRules:{probe_db_name:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-DB"),trigger:"blur"}],probe_interval:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-zhouqi-miao"),trigger:"blur"}],probe_timeout:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-chaoshi-miao"),trigger:"blur"}],probe_retry_cnt:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tanceshibai-message"),trigger:"blur"}],probe_retry_interval:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-shibaihou-message"),trigger:"blur"}],probe_pri_sql:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-zhuku-SQL"),trigger:"blur"}],probe_stb_sql:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-beiku-SQL"),trigger:"blur"}]},createDBconfigForm:{},createDBconfigFormList:[],createDBconfigFormDict:{},createDBconfigFormRules:{},active:0,ClusterDbRows:[],memMax:1024,iscanpush:!1,curHostOptions:[],editProp:["repl_ip","pgdata","scores"],showPgText:"",isolationSwitch:!0,timeIsolation:null,language:"",initCreateOption:[{name:"storage_size",cname:this.$t("createDatabasePage.cunchu-guige"),countType:["10GB","100GB","1TB","2TB","5TB","10TB"],span:12},{name:"wal_segsize",cname:this.$t("createPolardbCluster.wal-wenjian-daxiao"),countType:["16MB","32MB","64MB","128MB","256MB","512MB","1GB","2GB","4GB"],span:6}],vipPoolList:[],title:""}},props:["data-type"],watch:{createSrClusterFormVisible:function(e){!1===e&&(this.createSrClusterInfoForm={},this.createSrClusterDbForm={scores:0,repl_ip:"",pgdata:""},this.createSrClusterProbeForm={},this.ClusterDbRows=[],this.active=0)}},methods:{allotOneVip(){if(!this.createSrClusterInfoForm.pool_id)return o(this.$t("computerRoomConfig.qingxuanze-vip-chi-id"),"warning"),!1;let t={pool_id:this.createSrClusterInfoForm.pool_id};e.allotOneVip(t).then((e=>{o(this.$t("computerRoomConfig.fenpei-vip-wei-m",[e])),this.createSrClusterInfoForm.vip=e}))},selectPgBinPath(t){const r=this;if(this.$set(this.createSrClusterDbForm,"pg_bin_path",t),!t)return!1;let a={host:r.createSrClusterDbForm.host,pg_bin_path:r.createSrClusterDbForm.pg_bin_path};r.loading_version=!0,e.getPgBinVersion(a).then((e=>{0==e.err_code?this.$set(r.createSrClusterDbForm,"version",e.version):r.$message({message:e.err_msg,type:"error"}),r.loading_version=!1}),(function(e){r.loading_version=!1}))},validOsUser(t,r,a){const s=this;if(""==s.createSrClusterDbForm.os_user)return void a();let i={host:s.createSrClusterDbForm.host,user:r};s.loading_os_user=!0,e.checkOsUserExists(i).then((e=>{s.loading_os_user=!1,0==e.err_code?0==e.exists?(s.os_uid_disabled=!1,s.createSrClusterDbForm.create_os_user=!0,s.createSrClusterDbForm.os_uid&&s.$refs.createSrClusterDbForm.validateField("os_uid"),a()):(s.os_uid_disabled=!0,s.createSrClusterDbForm.create_os_user=!1,s.$refs.createSrClusterDbForm.clearValidate("os_uid"),s.$set(s.createSrClusterDbForm,"os_uid",e.exists),a()):a(new Error(e.err_msg))}),(function(e){a(new Error(e)),s.loading_os_user=!1}))},validOsUid(t,r,a){const s=this;if(""==s.createSrClusterDbForm.os_uid)return void a();if(s.os_uid_disabled)return void a();let i={host:s.createSrClusterDbForm.host,os_uid:r};s.loading_os_user=!0,e.checkOsUidExists(i).then((e=>{s.loading_os_user=!1,0==e.err_code?0==e.exists||s.os_uid_disabled?a():a(new Error(this.$t("createDatabasePage.yonghu-uid")+r+this.$t("createDatabasePage.yicunzai"))):a(new Error(e.err_msg))}),(function(e){a(new Error(e)),s.loading_os_user=!1}))},openCreateDialog(){const t=this;this.dataType=t.$props.dataType,1==this.dataType?t.title=this.$t("createStreamReplicationCluster.chaungjian-liufuzhi-message"):3==this.dataType&&(t.title=this.$t("createStreamReplicationCluster.chaungjian-PolarDB-message")),console.log("that.dataType",this.dataType),this.createSrClusterFormVisible=!0,this.createSrClusterDbForm={scores:0,repl_ip:"",pgdata:"",wal_segsize:"16MB",storage_size:"10GB"},this.createSrClusterInfoForm={cluster_name:"",vip:"",port:"",pgdata:"",db_user:"",db_pass:"",repl_user:"",repl_pass:""},this.createSrClusterProbeForm={auto_failback:!1,probe_db_name:"cs_sys_ha",probe_interval:"10",probe_timeout:"10",probe_retry_cnt:"2",probe_retry_interval:"5",probe_pri_sql:"UPDATE cs_sys_heartbeat SET hb_time = now()",probe_stb_sql:"SELECT 1",trigger_db_name:"",trigger_db_func:"",remark:""},e.getPgFamilyInfo().then((e=>(t.showPgText=e.pg_family_user,!0)),(e=>{throw new Error("get pg_family_name error")})).then((e=>{t.setHostIsolationFunc(e)})).catch((e=>{throw new Error("'openCreateDialog' function error")}))},setHostIsolationFunc(t){const r=this;r.$nextTick((()=>{const t=n(".createStreamReplicationCluster .el-dialog");e.getDBHostList().then((function(e){if(0===e.length)return t.close(),r.$message({type:"warning",message:r.$t("createStreamReplicationCluster.shujuku-suozai-m")});r.curHostOptions=e;let a=e.find((e=>e.mem_size>=64));return null==a&&(a=r.curHostOptions[0]),r.memMax=a.mem_size,t.close(),r.memMax<64?r.$message({type:"error",message:r.$t("createDatabasePage.gaizhuji-shengyu-message")}):void 0}),(function(e){t.close()}))}))},SelectChange(e){this.$refs.createDBconfigForm.validateField(e)},getPgPathList(){const t=this;this.$set(t.createSrClusterDbForm,"pg_bin_path",""),this.$set(t.createSrClusterDbForm,"version","");let r={host:t.createSrClusterDbForm.host};t.loading_pg_bin_path_list=!0,e.getPgBinPathList(r).then((e=>{if(t.loading_pg_bin_path_list=!1,t.pg_bin_path_list=e,t.ClusterDbRows.length>0){t.pg_bin_path_list.find((e=>e==t.ClusterDbRows[0].pg_bin_path))&&(this.$set(t.createSrClusterDbForm,"pg_bin_path",t.ClusterDbRows[0].pg_bin_path),this.selectPgBinPath(t.ClusterDbRows[0].pg_bin_path))}}),(function(e){t.loading_pg_bin_path_list=!1}))},calcUnitValue(e){if(null==e)return 1;if(""===e)return 1;if("B"===e)return 1;if("kB"===e)return 1024;if("MB"===e)return 1048576;if("GB"===e)return 1073741824;if("TB"===e)return 1099511627776;if("ms"===e)return 1;if("s"===e)return 1e3;if("min"===e)return 6e4;if("h"===e)return 36e5;if("d"===e)return 864e5;throw new Error(this.$t("createDatabasePage.wuxiao-danwei")+e)},validateRange(e,t,r){console.log("rule is "),console.log(e);var a=this.createDBconfigFormDict[e.field];if("listen_addresses"!=e.field){if(null==t||""==t)return"archive_command"==e.field?void r():void r(new Error(this.$t("createDatabasePage.bixu-shuru-yigezhi")));if(console.log("itemdata is "),console.log(a),null!=a.min_val||null!=a.max_val){var s=this.createDBconfigForm[e.field].unit,l=1;null!=s?l=this.calcUnitValue(s):s="";var o,n=0;if(3==a.setting_type||4==a.setting_type?(n=parseFloat(t.val),console.log("value="+t.val+",unit="+s+", unitValue="+l),o=t.val):(n=parseFloat(t),console.log("value="+t+",unit="+s+", unitValue="+l),o=t),isNaN(n))r(new Error(this.$t("createDatabasePage.qingshuru-shuzi")));else{var c=0,u=0,m=!0;"-∞"!=(c=null==a.min_val?"-∞":parseFloat(a.min_val))&&n*l<c&&(m=!1),"∞"!=(u=null==a.max_val?"∞":parseFloat(a.max_val))&&n*l>u&&(m=!1),console.log("minValue="+c+", maxValue="+u),m||(console.log(t),r(new Error(this.$t("createDatabasePage.shuru-dezhi")+o+s+this.$t("createDatabasePage.chaoguo-fanwei")+c+", "+u+"]"))),r()}}else r()}else i(e,t,r)},sortData:e=>(e.sort((function(e,t){return e.order_id<t.order_id?-1:e.order_id>t.order_id?1:0})),e),tableRowClassName:({row:e,rowIndex:t})=>t%2!=0?"warning-row":"success-row",changeIpData(e){const t=this;if(t.createSrClusterDbForm.repl_ip=t.createSrClusterDbForm.host,this.createSrClusterDbForm.pgdata&&this.$refs.createSrClusterDbForm.validateField("pgdata"),!e)return!1;t.getPgPathList()},retrievePgInitConf:function(){const t=this;let r={version:t.version};3==this.dataType&&(r.db_type=11),t.loading=!0,e.getInitDbConf(r).then((function(e){t.loading=!1;let r=e.setting_list;t.createDBconfigForm={};for(let a=0;a<r.length;a++)if(t.createDBconfigFormDict[r[a].setting_name]=r[a],t.createDBconfigFormRules[r[a].setting_name]=[{required:!0,validator:t.validateRange,trigger:"blur"}],3===r[a].setting_type||4===r[a].setting_type){let e=["min_wal_size","max_wal_size","wal_keep_size"],s=r[a].unit,i=Number(r[a].val),l=null;"track_activity_query_size"==r[a].setting_name&&""==r[a].unit&&(s="B"),e.includes(r[a].setting_name)&&(l=c(t.modifyDBConfigFun(r[a].setting_name))),null!=l&&(i=l.value,s=l.unit),t.$set(t.createDBconfigForm,r[a].setting_name,{val:i,unit:s})}else{let e=r[a].val;["wal_keep_segments"].includes(r[a].setting_name)&&(e=t.modifyDBConfigFun(r[a].setting_name)),t.$set(t.createDBconfigForm,r[a].setting_name,e)}r=t.sortData(r),t.mostCommonlyUsedRow=[],t.commonlyUsedRow=[],t.commonlyRow=[];for(let a=0;a<r.length;a++)1==r[a].common_level&&t.mostCommonlyUsedRow.push(r[a]),2==r[a].common_level&&t.commonlyUsedRow.push(r[a]),3==r[a].common_level&&t.commonlyRow.push(r[a]);t.createDBconfigFormList=t.mostCommonlyUsedRow,t.loading=!1}),(function(e){t.loading=!1}))},modifyDBConfigFun(e){let t=u(this.createSrClusterDbForm.wal_segsize),{value:r,unit:a}=m(this.createSrClusterDbForm.storage_size),s=u(this.createSrClusterDbForm.storage_size),i=1024;if("min_wal_size"===e||"max_wal_size"===e){let s,i;10===r&&"GB"===a?(s=Math.floor(u("320MB")/t),i=Math.floor(u("1GB")/t)):100===r&&"GB"===a?(s=Math.floor(u("1GB")/t),i=Math.floor(u("5GB")/t)):(s=Math.floor(u("2GB")/t),i=Math.floor(u("20GB")/t));let l=s>=2?t*s:2*t,o=i>0?t*i:4*t;return o<=l&&(o=4*l),o>=20480&&(o=20480),"min_wal_size"===e?l:o}if("wal_keep_size"===e){let e=s/i,t=u(Number((.1*e/(e/10)**.25).toFixed(2)),"GB");return Math.ceil(t)}if("wal_keep_segments"===e){let e=s/i,r=u(Number((.1*e/(e/10)**.25).toFixed(2)),"GB")/t;return Math.ceil(r)}throw new Error("没有找到对应的参数")},createSrClusteSubmit:function(){let t=this;this.$refs.createDBconfigForm.validate((a=>{if(a){let a=Object.assign({},t.createDBconfigForm),s=[];for(let e in a)a[e].unit?s.push({setting_name:e,val:a[e].val,unit:a[e].unit}):s.push({setting_name:e,val:a[e]});let i=Object.assign(this.createSrClusterInfoForm,{db_list:this.ClusterDbRows},{setting_list:s},this.createSrClusterProbeForm),o=l(i);o.repl_pass=r.ToDbText(o.repl_pass),o.db_pass=r.ToDbText(o.db_pass),o.port=Number(o.port),o.wal_segsize=u(t.createSrClusterDbForm.wal_segsize),delete o.storage_size;const c=n(".createStreamReplicationCluster .el-dialog");1==this.dataType?e.createSrCluster(o).then((function(e){c.close(),t.createSrClusterFormVisible=!1,t.$emit("refreshTable"),t.$emit("open-task",e.task_id)}),(function(e){c.close()})):3==this.dataType&&e.createPolardbUnsdCluster(o).then((function(e){c.close(),t.createSrClusterFormVisible=!1,t.$emit("refreshTable"),t.$emit("open-task",e.task_id)}),(function(e){c.close()}))}}))},next_step:function(){const t=this;switch(this.active){case 0:this.active++;let r={page_num:1,page_size:9999,filter:""};e.getVipPool(r).then((e=>{this.vipPoolList=e.rows}));break;case 1:this.$refs.createSrClusterInfoForm.validate((e=>{e&&this.active++}));break;case 2:this.$refs.createSrClusterProbeForm.validate((e=>{e&&(this.retrievePgInitConf(),this.active++)}));break;case 3:this.$refs.createDBconfigForm.validate((e=>{e&&(t.createDBconfigFormList=t.commonlyUsedRow,this.active++)}));break;case 4:this.$refs.createDBconfigForm.validate((e=>{e&&(t.createDBconfigFormList=t.commonlyRow,this.active++)}))}},lastfun(){const e=this;5==e.active?(e.active--,e.createDBconfigFormList=e.commonlyUsedRow):4==e.active?(e.active--,e.createDBconfigFormList=e.mostCommonlyUsedRow):3==e.active&&e.active--},showRow(e){this.radio=this.ClusterDbRows.indexOf(e),this.selected=e},addClusterDbBtn(){const e=this;e.$refs.createSrClusterDbForm.validate((t=>{if(t){let t={};e.version=e.createSrClusterDbForm.version;let a=Object.assign({},e.createSrClusterDbForm,t);for(var r in e.ClusterDbRows.push(a),console.log(e.ClusterDbRows),e.curHostOptions)e.curHostOptions[r].ip===e.createSrClusterDbForm.host&&(e.curHostOptions[r].is_using=1);e.createSrClusterDbForm.host="",e.createSrClusterDbForm.repl_ip="",e.pg_bin_path_list=[],e.$set(e.createSrClusterDbForm,"pg_bin_path",""),e.$set(e.createSrClusterDbForm,"version","")}}))},emptyClusterDbBtn(){for(var e in this.ClusterDbRows=[],this.curHostOptions){this.curHostOptions[e].is_using=0}},deleteClusterDbBtn(e,t){for(var r in this.ClusterDbRows.splice(e,1),this.curHostOptions)this.curHostOptions[r].ip===t.host&&(this.curHostOptions[r].is_using=0)},handleCellEnter(e,t,r,a){t.property in this.editProp&&null!=r.querySelector(".item__txt")&&r.querySelector(".item__txt").classList.add("item__txt--hover")},handleCellLeave(e,t,r,a){const s=t.property;this.editProp.includes(s)&&null!=r.querySelector(".item__txt")&&(r.querySelector(".item__txt").classList.remove("item__txt--hover"),r.querySelector(".item__txt").style.display="block",r.querySelector(".item__input").style.display="none")},handleCellClick(e,t,r,a){const s=t.property;this.editProp.includes(s)&&(r.querySelector(".item__txt").style.display="none",r.querySelector(".item__input").style.display="block",r.querySelector("input").focus())},cancelEditable(e,t,r,a){const s=t.property;this.editProp.includes(s)&&(r.querySelector(".item__txt").style.display="block",r.querySelector(".item__input").style.display="none")}},mounted:function(){this.language=localStorage.getItem("language_clup"),this.createSrClusterDbFormRules.os_user.push({required:!0,validator:this.validOsUser,trigger:"blur"}),this.createSrClusterDbFormRules.os_uid.push({required:!0,validator:this.validOsUid,trigger:"blur"})}},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.createSrClusterFormVisible?r("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"createStreamReplicationCluster",attrs:{visible:e.createSrClusterFormVisible,"close-on-click-modal":!1,"element-loading-text":e.$t("Public.ping-ming-jia-zai-zhong"),width:"75%"},on:{"update:visible":function(t){e.createSrClusterFormVisible=t}}},[r("div",{attrs:{slot:"title"},slot:"title"},[r("span",{staticClass:"el-dialog__title"},[e._v(e._s(e.title))]),r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.genju-suotan-message"),placement:"top"}},[r("i",{staticClass:"el-icon-question"})])],1),r("el-steps",{staticStyle:{"margin-bottom":"20px"},attrs:{active:e.active,"finish-status":"success","align-center":""}},[r("el-step",{attrs:{title:e.$t("createDatabasePage.xuanze-shujuku")}}),r("el-step",{attrs:{title:e.$t("createStreamReplicationCluster.jiqun-xinxi")}}),r("el-step",{attrs:{title:e.$t("createStreamReplicationCluster.jiqun-tance")}}),r("el-step",{attrs:{title:e.$t("createDatabasePage.changyong-canshu-peizhi")}}),r("el-step",{attrs:{title:e.$t("createDatabasePage.yiban-canshu-peizhi")}}),r("el-step",{attrs:{title:e.$t("createDatabasePage.qita-canshu-peizhi")}})],1),r("el-col",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active===0"}],staticClass:"stepFirst"},[r("el-form",{ref:"createSrClusterDbForm",attrs:{model:e.createSrClusterDbForm,"label-width":"en"==e.language?"130px":"120px",rules:e.createSrClusterDbFormRules}},[r("el-row",[e._l(e.initCreateOption,(function(t){return r("div",{key:t.name},[r("el-col",{attrs:{span:t.span}},[r("el-form-item",{attrs:{label:t.cname,prop:t.name}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("createDatabasePage.qingxuanze-neirong",[t.cname])},model:{value:e.createSrClusterDbForm[t.name],callback:function(r){e.$set(e.createSrClusterDbForm,t.name,r)},expression:"createSrClusterDbForm[item.name]"}},e._l(t.countType,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),"wal_segsize"===t.name?r("el-col",{staticClass:"wal_segsize-warning",attrs:{span:6}},[r("span",{staticClass:"wal_segsize-warning_words",attrs:{title:e.$t("createDatabasePage.cicanshu-zhizhichi-m")}},[e._v(" "+e._s(e.$t("createDatabasePage.cicanshu-zhizhichi-m"))+" ")])]):e._e()],1)})),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("dbList.suozai-zhuji"),prop:"host"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.$t("defineDatabasePage.qingxuanze-shujiku-message")},on:{change:e.changeIpData},model:{value:e.createSrClusterDbForm.host,callback:function(t){e.$set(e.createSrClusterDbForm,"host",t)},expression:"createSrClusterDbForm.host"}},e._l(e.curHostOptions,(function(t){return r("el-option",{key:t.hid,attrs:{label:t.ip,value:t.ip,disabled:1!==t.state||1===t.is_using||t.mem_size<64}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,placement:"top",disabled:t.mem_size>64&&1===t.state,effect:"dark",content:1!==t.state?e.$t("dbList.agent-yichang"):e.$t("createDatabasePage.gaizhuji-shengyu-message")}},[r("div",{staticStyle:{overlow:"hiedden"}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.ip))]),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.hostname))])])])],1)})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.fuzhi-ip"),prop:"repl_ip"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-shujukude-fuzhiip")},on:{blur:function(t){e.createSrClusterDbForm.repl_ip=t.target.value.trim()}},model:{value:e.createSrClusterDbForm.repl_ip,callback:function(t){e.$set(e.createSrClusterDbForm,"repl_ip",t)},expression:"createSrClusterDbForm.repl_ip"}})],1)],1)],2),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{staticStyle:{width:"100%",float:"left"},attrs:{label:e.$t("createDatabasePage.caozuo-xitong-yonghu"),prop:"os_user"}},[r("el-input",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_os_user,expression:"loading_os_user"}],attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0)",placeholder:e.$t("createStreamReplicationCluster.caozuoxitong-yonghu")+e.showPgText+")"},model:{value:e.createSrClusterDbForm.os_user,callback:function(t){e.$set(e.createSrClusterDbForm,"os_user",t)},expression:"createSrClusterDbForm.os_user"}})],1)],1),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"UID",prop:"os_uid","label-width":"50px"}},[r("el-input",{attrs:{placeholder:e.$t("createDatabasePage.shuru-yonghu-UID"),disabled:e.os_uid_disabled},model:{value:e.createSrClusterDbForm.os_uid,callback:function(t){e.$set(e.createSrClusterDbForm,"os_uid",e._n(t))},expression:"createSrClusterDbForm.os_uid"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("createDatabasePage.shujuku-ruanjian"),prop:"pg_bin_path"}},[r("el-select",{staticStyle:{width:"100%",float:"left"},attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:e.$t("createDatabasePage.qingxuanze-shujuku-ruanjian")},on:{change:e.selectPgBinPath},model:{value:e.createSrClusterDbForm.pg_bin_path,callback:function(t){e.$set(e.createSrClusterDbForm,"pg_bin_path",t)},expression:"createSrClusterDbForm.pg_bin_path"}},e._l(e.pg_bin_path_list,(function(t){return r("el-option",{key:t,attrs:{label:t,value:t}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,placement:"top",effect:"dark",content:e.$t("createStandbyPage.shujuku-ruanjian-lujing")}},[r("div",{staticStyle:{overlow:"hiedden"}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t))])])])],1)})),1)],1)],1),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:e.$t("licManager.ban-ben"),"label-width":"60px",prop:"version"}},[r("el-input",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_version,expression:"loading_version"}],staticStyle:{width:"100%",float:"left"},attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0)",disabled:""},model:{value:e.createSrClusterDbForm.version,callback:function(t){e.$set(e.createSrClusterDbForm,"version",t)},expression:"createSrClusterDbForm.version"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("defineDatabasePage.shuju-mulu"),prop:"pgdata"}},[r("el-input",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_pgdata,expression:"loading_pgdata"}],attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0)",placeholder:e.$t("defineDatabasePage.shuju-mulu-placeholder")},on:{blur:function(t){e.createSrClusterDbForm.pgdata=t.target.value.trim()}},model:{value:e.createSrClusterDbForm.pgdata,callback:function(t){e.$set(e.createSrClusterDbForm,"pgdata",t)},expression:"createSrClusterDbForm.pgdata"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.youxianji"),prop:"scores"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-shujuke-youxianji-message")},model:{value:e.createSrClusterDbForm.scores,callback:function(t){e.$set(e.createSrClusterDbForm,"scores",e._n(t))},expression:"createSrClusterDbForm.scores"}})],1)],1)],1)],1),r("div",{staticStyle:{"text-align":"right"}},[r("span",{staticStyle:{color:"red","font-size":"14px"}},[e._v(e._s(e.$t("createStreamReplicationCluster.moren-huijiang-message")))]),r("el-button",{staticClass:"normal el-icon-delete",on:{click:e.emptyClusterDbBtn}},[e._v(" "+e._s(e.$t("createStreamReplicationCluster.qing-kong")))]),r("el-button",{staticClass:"highlight el-icon-plus",staticStyle:{"background-color":"#0070cc"},attrs:{disabled:e.iscanpush},on:{click:e.addClusterDbBtn}},[e._v(" "+e._s(e.$t("createStreamReplicationCluster.tian-jia")))])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.ClusterDbRows,border:"","element-loading-text":e.$t("Public.zhengzai-jiazai"),"row-class-name":e.tableRowClassName},on:{"cell-mouse-enter":e.handleCellEnter,"cell-mouse-leave":e.handleCellLeave,"cell-click":e.handleCellClick}},[r("el-table-column",{attrs:{prop:"host",label:e.$t("dashboard.zhu-ji"),align:"center"}}),r("el-table-column",{attrs:{prop:"repl_ip",label:e.$t("createStreamReplicationCluster.fuzhi-ip"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"item"},[r("el-input",{staticClass:"item__input",attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-fuzhiip")},model:{value:t.row.repl_ip,callback:function(r){e.$set(t.row,"repl_ip",r)},expression:"scope.row.repl_ip"}}),r("div",{staticClass:"item__txt"},[e._v(e._s(t.row.repl_ip))])],1)}}],null,!1,2970128828)}),r("el-table-column",{attrs:{prop:"os_user",label:e.$t("createDatabasePage.caozuo-xitong-yonghu"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"item"},[r("el-input",{staticClass:"item__input",model:{value:t.row.os_user,callback:function(r){e.$set(t.row,"os_user",r)},expression:"scope.row.os_user"}}),r("div",{staticClass:"item__txt"},[e._v(e._s(t.row.os_user))])],1)}}],null,!1,1420592e3)}),r("el-table-column",{attrs:{prop:"os_uid",label:"UID",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"item"},[r("el-input",{staticClass:"item__input",model:{value:t.row.os_uid,callback:function(r){e.$set(t.row,"os_uid",r)},expression:"scope.row.os_uid"}}),r("div",{staticClass:"item__txt"},[e._v(e._s(t.row.os_uid))])],1)}}],null,!1,274622848)}),r("el-table-column",{attrs:{width:"160px",prop:"pg_bin_path",label:e.$t("createStreamReplicationCluster.PG-ruanjian-mulu"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"item"},[r("el-input",{staticClass:"item__input",model:{value:t.row.pg_bin_path,callback:function(r){e.$set(t.row,"pg_bin_path",r)},expression:"scope.row.pg_bin_path"}}),r("div",{staticClass:"item__txt"},[e._v(e._s(t.row.pg_bin_path))])],1)}}],null,!1,2915343520)}),r("el-table-column",{attrs:{prop:"version",label:e.$t("createStreamReplicationCluster.ruanjian-banben"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"item"},[r("el-input",{staticClass:"item__input",model:{value:t.row.version,callback:function(r){e.$set(t.row,"version",r)},expression:"scope.row.version"}}),r("div",{staticClass:"item__txt"},[e._v(e._s(t.row.version))])],1)}}],null,!1,1172751104)}),r("el-table-column",{attrs:{prop:"pgdata",label:e.$t("defineDatabasePage.shuju-mulu"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"item"},[r("el-input",{staticClass:"item__input",attrs:{placeholder:e.$t("defineDatabasePage.qingshuru-shuju-mulu")},model:{value:t.row.pgdata,callback:function(r){e.$set(t.row,"pgdata",r)},expression:"scope.row.pgdata"}}),r("div",{staticClass:"item__txt"},[e._v(e._s(t.row.pgdata))])],1)}}],null,!1,1078291277)}),r("el-table-column",{attrs:{prop:"scores",label:e.$t("createStreamReplicationCluster.youxianji"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"item"},[r("el-input",{staticClass:"item__input",attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-youxianji")},model:{value:t.row.scores,callback:function(r){e.$set(t.row,"scores",r)},expression:"scope.row.scores"}}),r("div",{staticClass:"item__txt"},[e._v(e._s(t.row.scores))])],1)}}],null,!1,1423580467)}),r("el-table-column",{attrs:{prop:"detail",label:e.$t("dbList.cao-zuo"),align:"center",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-link",{on:{click:function(r){return e.deleteClusterDbBtn(t.$index,t.row)}}},[e._v(e._s(e.$t("dbList.shan-chu")))])]}}],null,!1,2962929254)})],1)],1),r("el-form",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active===1"}],ref:"createSrClusterInfoForm",attrs:{model:e.createSrClusterInfoForm,"label-width":"en"==e.language?"180px":"160px",rules:e.createSrClusterInfoFormRules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("clusterDefine.jiqun-mingcheng"),prop:"cluster_name"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-jiqun-mingcheng")},on:{blur:function(t){e.createSrClusterInfoForm.cluster_name=t.target.value.trim()}},model:{value:e.createSrClusterInfoForm.cluster_name,callback:function(t){e.$set(e.createSrClusterInfoForm,"cluster_name",t)},expression:"createSrClusterInfoForm.cluster_name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("defineDatabasePage.shuju-duankou"),prop:"port"}},[r("el-input",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_port,expression:"loading_port"}],attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0)",placeholder:e.$t("defineDatabasePage.shuju-duankou-placeholder")},on:{blur:function(t){e.createSrClusterInfoForm.port=t.target.value.trim()}},model:{value:e.createSrClusterInfoForm.port,callback:function(t){e.$set(e.createSrClusterInfoForm,"port",t)},expression:"createSrClusterInfoForm.port"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("defineDatabasePage.DB-zhongde-yonghu"),prop:"db_user"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-shujuku-message")+e.showPgText+")"},model:{value:e.createSrClusterInfoForm.db_user,callback:function(t){e.$set(e.createSrClusterInfoForm,"db_user",t)},expression:"createSrClusterInfoForm.db_user"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("defineDatabasePage.DB-zhongde-mima"),prop:"db_pass"}},[r("el-input",{attrs:{"show-password":"",placeholder:e.$t("defineDatabasePage.DB-zhongde-mima-placeholder")},model:{value:e.createSrClusterInfoForm.db_pass,callback:function(t){e.$set(e.createSrClusterInfoForm,"db_pass",t)},expression:"createSrClusterInfoForm.db_pass"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("createStandbyPage.liufuzhi-yonghu"),prop:"repl_user"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-liufuzhi-yonghu")},on:{blur:function(t){e.createSrClusterInfoForm.repl_user=t.target.value.trim()}},model:{value:e.createSrClusterInfoForm.repl_user,callback:function(t){e.$set(e.createSrClusterInfoForm,"repl_user",t)},expression:"createSrClusterInfoForm.repl_user"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("createStandbyPage.liufuzhi-mima"),prop:"repl_pass"}},[r("el-input",{attrs:{"show-password":"",placeholder:e.$t("createStreamReplicationCluster.qingshuru-liufuzhi-yonghude-mima"),disabled:e.ischeckpass},on:{blur:function(t){e.createSrClusterInfoForm.repl_pass=t.target.value.trim()}},model:{value:e.createSrClusterInfoForm.repl_pass,callback:function(t){e.$set(e.createSrClusterInfoForm,"repl_pass",t)},expression:"createSrClusterInfoForm.repl_pass"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("computerRoomConfig.vip-chi"),prop:"pool_id"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("computerRoomConfig.qingxuanze-vip-chi-id")},model:{value:e.createSrClusterInfoForm.pool_id,callback:function(t){e.$set(e.createSrClusterInfoForm,"pool_id",t)},expression:"createSrClusterInfoForm.pool_id"}},e._l(e.vipPoolList,(function(t){return r("el-option",{key:t.pool_id,attrs:{label:t.pool_id+" ("+t.start_ip+"~"+t.end_ip+")",value:t.pool_id}},[r("span",{staticClass:"fl"},[e._v(e._s(t.pool_id))]),r("span",{staticClass:"fr",staticStyle:{color:"#8492a6","font-size":"13px"}},[e._v("("+e._s(t.start_ip)+" ~ "+e._s(t.end_ip)+")")])])})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.jiqun-vip"),prop:"vip"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-jiqunde-vip")},on:{blur:function(t){e.createSrClusterInfoForm.vip=t.target.value.trim()}},model:{value:e.createSrClusterInfoForm.vip,callback:function(t){e.$set(e.createSrClusterInfoForm,"vip",t)},expression:"createSrClusterInfoForm.vip"}})],1)],1),r("el-col",{attrs:{span:2}},[r("el-form-item",{attrs:{label:"",prop:"","label-width":"10px"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.allotOneVip}},[e._v(e._s(e.$t("computerRoomConfig.fenpei")))])],1)],1)],1)],1),r("el-col",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active===2"}],staticStyle:{margin:"5px 0"}},[r("el-form",{ref:"createSrClusterProbeForm",attrs:{model:e.createSrClusterProbeForm,"label-width":"en"==e.language?"160px":"120px",rules:e.createSrClusterProbeFormRules}},[r("el-row",[r("el-col",{attrs:{span:"en"==e.language?12:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-DB"),prop:"probe_db_name"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:"cs_sys_ha",placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-tance-DB")},model:{value:e.createSrClusterProbeForm.probe_db_name,callback:function(t){e.$set(e.createSrClusterProbeForm,"probe_db_name",t)},expression:"createSrClusterProbeForm.probe_db_name"}})],1)],1)],1),r("el-col",{attrs:{span:"en"==e.language?12:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-zhouqi-miao"),prop:"probe_interval"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.qingshuru-tance-zhouqi-miao"),placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-tance-zhouqi-miao")},model:{value:e.createSrClusterProbeForm.probe_interval,callback:function(t){e.$set(e.createSrClusterProbeForm,"probe_interval",t)},expression:"createSrClusterProbeForm.probe_interval"}})],1)],1)],1),r("el-col",{attrs:{span:"en"==e.language?12:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-chaoshi-miao"),prop:"probe_timeout"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.qingshuru-tance-chaoshi-miao"),placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-tance-chaoshi-miao")},model:{value:e.createSrClusterProbeForm.probe_timeout,callback:function(t){e.$set(e.createSrClusterProbeForm,"probe_timeout",t)},expression:"createSrClusterProbeForm.probe_timeout"}})],1)],1)],1),r("el-col",{attrs:{span:"en"==e.language?12:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-chongshi-cishu"),prop:"probe_retry_cnt"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.qingshuru-tanceshibai-message"),placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-tanceshibai-message")},model:{value:e.createSrClusterProbeForm.probe_retry_cnt,callback:function(t){e.$set(e.createSrClusterProbeForm,"probe_retry_cnt",t)},expression:"createSrClusterProbeForm.probe_retry_cnt"}})],1)],1)],1),r("el-col",{attrs:{span:"en"==e.language?12:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.chongshi-jiange-miao"),prop:"probe_retry_interval"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.qingshuru-tance-shibaihou-message"),placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-tance-shibaihou-message")},model:{value:e.createSrClusterProbeForm.probe_retry_interval,callback:function(t){e.$set(e.createSrClusterProbeForm,"probe_retry_interval",t)},expression:"createSrClusterProbeForm.probe_retry_interval"}})],1)],1)],1),r("el-col",{attrs:{span:"en"==e.language?12:8}},[r("el-form-item",{attrs:{"label-width":"en"==e.language?"260px":"",label:e.$t("createStreamReplicationCluster.shifou-zidong-jiahui-jiqun"),prop:"auto_failback"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.beikuguzhang-message"),placement:"top-end"}},[r("el-select",{attrs:{placeholder:e.$t("createDatabasePage.qing-xuan-ze")},model:{value:e.createSrClusterProbeForm.auto_failback,callback:function(t){e.$set(e.createSrClusterProbeForm,"auto_failback",t)},expression:"createSrClusterProbeForm.auto_failback"}},[r("el-option",{attrs:{label:e.$t("dbList.shi"),value:!0}}),r("el-option",{attrs:{label:e.$t("dbList.fou"),value:!1}})],1)],1)],1)],1)],1),r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-zhuku-SQL"),prop:"probe_pri_sql"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:"UPDATE cs_sys_heartbeat SET hb_time = now()",placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-tance-zhuku-SQL")},on:{blur:function(t){e.createSrClusterProbeForm.probe_pri_sql=t.target.value.trim()}},model:{value:e.createSrClusterProbeForm.probe_pri_sql,callback:function(t){e.$set(e.createSrClusterProbeForm,"probe_pri_sql",t)},expression:"createSrClusterProbeForm.probe_pri_sql"}})],1)],1),r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-beiku-SQL"),prop:"probe_stb_sql"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:"SELECT 1",placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-tance-beiku-SQL")},on:{blur:function(t){e.createSrClusterProbeForm.probe_stb_sql=t.target.value.trim()}},model:{value:e.createSrClusterProbeForm.probe_stb_sql,callback:function(t){e.$set(e.createSrClusterProbeForm,"probe_stb_sql",t)},expression:"createSrClusterProbeForm.probe_stb_sql"}})],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.chufa-DBmingcheng"),prop:"trigger_db_name"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.dangfasheng-guzhang-qiehuanshi-message"),placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.dangfasheng-guzhang-qiehuanshi-message")},on:{blur:function(t){e.createSrClusterProbeForm.trigger_db_name=t.target.value.trim()}},model:{value:e.createSrClusterProbeForm.trigger_db_name,callback:function(t){e.$set(e.createSrClusterProbeForm,"trigger_db_name",t)},expression:"createSrClusterProbeForm.trigger_db_name"}})],1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.chufa-DBhanshu"),prop:"trigger_db_func"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.dangfasheng-guzhang-qiehuan-message"),placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.dangfasheng-guzhang-qiehuan-message")},on:{blur:function(t){e.createSrClusterProbeForm.trigger_db_func=t.target.value.trim()}},model:{value:e.createSrClusterProbeForm.trigger_db_func,callback:function(t){e.$set(e.createSrClusterProbeForm,"trigger_db_func",t)},expression:"createSrClusterProbeForm.trigger_db_func"}})],1)],1)],1)],1),r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.bei-zhu"),prop:"remark"}},[r("el-input",{attrs:{placeholder:e.$t("createStreamReplicationCluster.qingshuru-beizhu")},on:{blur:function(t){e.createSrClusterProbeForm.remark=t.target.value.trim()}},model:{value:e.createSrClusterProbeForm.remark,callback:function(t){e.$set(e.createSrClusterProbeForm,"remark",t)},expression:"createSrClusterProbeForm.remark"}})],1)],1)],1),r("el-col",{directives:[{name:"show",rawName:"v-show",value:e.active>=3,expression:"active>=3"}],staticStyle:{margin:"5px 0"}},[r("el-form",{ref:"createDBconfigForm",staticStyle:{"overflow-y":"auto","max-height":"480px","min-width":"1120px"},attrs:{model:e.createDBconfigForm,"label-width":"254px",rules:e.createDBconfigFormRules}},[r("el-row",e._l(e.createDBconfigFormList,(function(t,a){return r("el-col",{key:a,attrs:{span:10}},[1==t.setting_type?r("el-form-item",{attrs:{label:t.setting_name,prop:t.setting_name}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:t.notes,placement:"top-end"}},[r("el-input",{attrs:{placeholder:e.$t("createDatabasePage.qingshuru-neirong")},model:{value:e.createDBconfigForm[e.createDBconfigFormList[a].setting_name],callback:function(t){e.$set(e.createDBconfigForm,e.createDBconfigFormList[a].setting_name,t)},expression:"createDBconfigForm[createDBconfigFormList[index].setting_name]"}})],1)],1):e._e(),2==t.setting_type?r("el-form-item",{attrs:{label:t.setting_name,prop:t.setting_name}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:t.notes,placement:"top-end"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("createDatabasePage.qing-xuan-ze")},model:{value:e.createDBconfigForm[e.createDBconfigFormList[a].setting_name],callback:function(t){e.$set(e.createDBconfigForm,e.createDBconfigFormList[a].setting_name,t)},expression:"createDBconfigForm[createDBconfigFormList[index].setting_name]"}},[r("el-option",{attrs:{label:"off",value:"off"}}),r("el-option",{attrs:{label:"on",value:"on"}})],1)],1)],1):e._e(),3==t.setting_type?r("el-form-item",{attrs:{label:t.setting_name,prop:t.setting_name}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,disabled:!t.notes,effect:"dark",content:t.notes,placement:"top-end"}},[r("el-input",{staticStyle:{width:"70%",float:"left"},attrs:{placeholder:e.$t("createDatabasePage.qingshuru-neirong")},model:{value:e.createDBconfigForm[e.createDBconfigFormList[a].setting_name].val,callback:function(t){e.$set(e.createDBconfigForm[e.createDBconfigFormList[a].setting_name],"val",t)},expression:"createDBconfigForm[createDBconfigFormList[index].setting_name].val"}})],1),r("el-select",{staticStyle:{width:"30%",float:"left"},attrs:{placeholder:e.$t("createDatabasePage.qing-xuan-ze")},on:{change:function(r){return e.SelectChange(t.setting_name)}},model:{value:e.createDBconfigForm[e.createDBconfigFormList[a].setting_name].unit,callback:function(t){e.$set(e.createDBconfigForm[e.createDBconfigFormList[a].setting_name],"unit",t)},expression:"createDBconfigForm[createDBconfigFormList[index].setting_name].unit"}},e._l(e.byteUnitDict,(function(e,t){return r("el-option",{key:e,attrs:{label:e,value:t}})})),1)],1):e._e(),4==t.setting_type?r("el-form-item",{attrs:{label:t.setting_name,prop:t.setting_name}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,disabled:!t.notes,effect:"dark",content:t.notes,placement:"top-end"}},[r("el-input",{staticStyle:{width:"70%",float:"left"},attrs:{placeholder:e.$t("createDatabasePage.qingshuru-neirong")},model:{value:e.createDBconfigForm[e.createDBconfigFormList[a].setting_name].val,callback:function(t){e.$set(e.createDBconfigForm[e.createDBconfigFormList[a].setting_name],"val",t)},expression:"createDBconfigForm[createDBconfigFormList[index].setting_name].val"}})],1),r("el-select",{staticStyle:{width:"30%",float:"left"},attrs:{placeholder:e.$t("createDatabasePage.qing-xuan-ze")},on:{change:function(r){return e.SelectChange(t.setting_name)}},model:{value:e.createDBconfigForm[e.createDBconfigFormList[a].setting_name].unit,callback:function(t){e.$set(e.createDBconfigForm[e.createDBconfigFormList[a].setting_name],"unit",t)},expression:"createDBconfigForm[createDBconfigFormList[index].setting_name].unit"}},e._l(e.timeUnitDict,(function(e,t){return r("el-option",{key:e,attrs:{label:e,value:t}})})),1)],1):e._e(),5==t.setting_type?r("el-form-item",{attrs:{label:t.setting_name,prop:t.setting_name}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,disabled:!t.notes,effect:"dark",content:t.notes,placement:"top-end"}},[r("el-select",{staticStyle:{width:"100%",float:"left"},attrs:{placeholder:e.$t("createDatabasePage.qing-xuan-ze")},model:{value:e.createDBconfigForm[e.createDBconfigFormList[a].setting_name],callback:function(t){e.$set(e.createDBconfigForm,e.createDBconfigFormList[a].setting_name,t)},expression:"createDBconfigForm[createDBconfigFormList[index].setting_name]"}},e._l(t.enumvals,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1)],1):e._e(),6==t.setting_type?r("el-form-item",{attrs:{label:t.setting_name,prop:t.setting_name}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,disabled:!t.notes,effect:"dark",content:t.notes,placement:"top-end"}},[r("el-input",{attrs:{placeholder:e.$t("createDatabasePage.qingshuru-neirong")},model:{value:e.createDBconfigForm[e.createDBconfigFormList[a].setting_name],callback:function(t){e.$set(e.createDBconfigForm,e.createDBconfigFormList[a].setting_name,t)},expression:"createDBconfigForm[createDBconfigFormList[index].setting_name]"}})],1)],1):e._e()],1)})),1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{nativeOn:{click:function(t){e.createSrClusterFormVisible=!1}}},[e._v(e._s(e.$t("index.qu-xiao")))]),0===e.active?r("el-button",{staticStyle:{"margin-top":"12px"},attrs:{disabled:e.ClusterDbRows.length<=1},on:{click:e.next_step}},[e._v(e._s(e.$t("createDatabasePage.xia-yi-bu")))]):1===e.active||2===e.active?[r("el-button",{staticStyle:{"margin-top":"12px"},on:{click:function(t){e.active--}}},[e._v(e._s(e.$t("createDatabasePage.shang-yi-bu")))]),r("el-button",{staticStyle:{"margin-top":"12px"},on:{click:e.next_step}},[e._v(e._s(e.$t("createDatabasePage.xia-yi-bu")))])]:e.active>=3?[r("el-button",{staticStyle:{"margin-top":"12px"},on:{click:e.lastfun}},[e._v(e._s(e.$t("createDatabasePage.shang-yi-bu")))]),5!=e.active?r("el-button",{staticStyle:{"margin-top":"12px"},on:{click:e.next_step}},[e._v(e._s(e.$t("createDatabasePage.xia-yi-bu")))]):e._e(),5==e.active?r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.createSrClusteSubmit}},[e._v(e._s(e.$t("defineDatabasePage.ti-jiao")))]):e._e()]:e._e()],2)],1):e._e()}),[],!1,d,"c59bba00",null,null);function d(e){for(let t in p)this[t]=p[t]}var _=function(){return g.exports}();export{_ as default};
