import{A as t}from"./api_systemManagement.1f6cc404.js";import{a as e,s as a}from"./staticTools.84335405.js";import{n as i}from"./index.851f4377.js";import"./index.dfdb83b1.js";import"./vendor.194c4086.js";import"./bus.d56574c1.js";const n={};var s=i({data:()=>({dbInfo:null,dbUpdataLists:null,radioSelectInfo:null,paginationInfo:{currentPage:1,size:10,total:0},filters:{},dbUpdataPropsVisible:!1}),mounted(){},methods:{updataDBProps(){const i=e(".dbUpdataPropsDialog .el-dialog");let n={db_id:this.radioSelectInfo.db_id,pg_version:this.dbInfo.pg_version};t.updatePGsettings(n).then((t=>{a(this.$t("bestConfigInfo.gengxin-chenggong")),i.close(),this.dbUpdataPropsVisible=!1,this.$emit("updataInfo")}),(t=>{i.close()}))},sizeChange(t){this.paginationInfo.size=t,this.getInfo()},currentChange(t){this.paginationInfo.currentPage=t,this.getInfo()},search(){this.$refs.pagination.$emit("current-change",1),this.getInfo()},checkSelect(t){this.radioSelectInfo=t},openDialog(t){this.dbInfo=t,this.dbUpdataPropsVisible=!0,this.$nextTick((()=>this.getInfo()))},getInfo(){let{db_id:a}=this.filters,i={page_size:this.paginationInfo.size,page_num:this.paginationInfo.currentPage,pg_version:this.dbInfo.pg_version,filter:a||""};const n=e(".dbUpdataPropsDialog .el-dialog");t.getPGSettings(i).then((t=>{this.dbUpdataLists=t.db_info_list||[],this.paginationInfo.total=t.count,n.close()}),(t=>{this.dbUpdataLists=[],n.close()}))},closeDialog(){this.dbUpdataPropsVisible=!1,this.radioSelectInfo=null}}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.dbUpdataPropsVisible?a("el-dialog",{staticClass:"dbUpdataPropsDialog",attrs:{title:t.$t("dbDefaultPropsUpdata.zhubanbenhao-m",[t.dbInfo.pg_version]),visible:t.dbUpdataPropsVisible,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(e){t.dbUpdataPropsVisible=e}}},[a("el-form",{staticClass:"filterForm",attrs:{model:t.filters},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:t.$t("dbDefaultPropsUpdata.qingshuru-db_id")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.filters.db_id,callback:function(e){t.$set(t.filters,"db_id",e)},expression:"filters.db_id"}},[a("el-button",{attrs:{slot:"append",type:"primary"},on:{click:t.search},slot:"append"},[t._v(t._s(t.$t("dbList.shou-suo")))])],1),a("el-tooltip",{attrs:{effect:"dark",content:t.$t("Public.question"),placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),a("el-form-item",{staticStyle:{flex:"1","text-align":"right",color:"red"}},[a("span",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.$t("dbDefaultPropsUpdata.huoqushujuku-canshu-m")))])])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dbUpdataLists,border:"","highlight-current-row":""},on:{"current-change":t.checkSelect}},[a("el-table-column",{attrs:{prop:"",label:"",width:"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-radio",{attrs:{label:i},model:{value:t.radioSelectInfo,callback:function(e){t.radioSelectInfo=e},expression:"radioSelectInfo"}},[t._v(t._s(""))])]}}],null,!1,957573602)}),a("el-table-column",{attrs:{prop:"db_id",label:"db_id","min-width":"180",align:"center"}}),a("el-table-column",{attrs:{prop:"host",label:"Host","min-width":"180",align:"center"}}),a("el-table-column",{attrs:{prop:"version",label:t.$t("BackupPlanManage.shujuku-banben"),"min-width":"180",align:"center"}})],1),a("div",{staticClass:"block clearfix"},[a("div",{staticClass:"fl"},[a("el-pagination",{ref:"pagination",attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":t.paginationInfo.size,"current-page":t.paginationInfo.currentPage,total:t.paginationInfo.total,"page-sizes":[10,20,30,40,50]},on:{"size-change":t.sizeChange,"current-change":t.currentChange}})],1)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v(t._s(t.$t("index.qu-xiao")))]),a("el-button",{attrs:{disabled:!t.radioSelectInfo,type:"primary"},on:{click:t.updataDBProps}},[t._v(t._s(t.$t("dynamicTools.que-ren")))])],1)],1):t._e()}),[],!1,o,"6dd99f26",null,null);function o(t){for(let e in n)this[e]=n[e]}const l={};var r=i({data:()=>({tableData:null,loading:!1}),mounted(){this.getInfo()},components:{dbDefaultPropsUpdata:function(){return s.exports}()},methods:{updata(t){this.$refs.dbDefaultPropsUpdata.openDialog(t)},getInfo(){this.loading=!0,t.getPGSettings().then((t=>{let e=[];for(const a in t.setted_info){let i={pg_version:a,is_set:t.setted_info[a]};e.push(i)}this.tableData=e,this.loading=!1}),(t=>{this.loading=!1}))}}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"warp"},[a("el-col",{staticClass:"warp-breadcrum",attrs:{span:24}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("span",[t._v(t._s(t.$t("dbDefaultProps.shujuku-morencanshu")))])])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":t.$t("Public.ping-ming-jia-zai-zhong"),data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"pg_version",label:t.$t("dbDefaultProps.zhubanben"),"min-width":"180",align:"center"}}),a("el-table-column",{attrs:{prop:"is_set",label:t.$t("dbDefaultProps.shifou-yishezhi"),"min-width":"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.is_set?"YES":"NO")+" ")]}}])}),a("el-table-column",{attrs:{prop:"",label:t.$t("dbList.cao-zuo"),"min-width":"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-link",{staticClass:"normal start",on:{click:function(e){return t.updata(i)}}},[t._v(t._s(t.$t("baseInfo.geng-xin")))])]}}])})],1)],1),a("dbDefaultPropsUpdata",{ref:"dbDefaultPropsUpdata",on:{updataInfo:t.getInfo}})],1)}),[],!1,d,"8b073dbe",null,null);function d(t){for(let e in l)this[e]=l[e]}var p=function(){return r.exports}();export{p as default};
