import{A as e}from"./api_dbManage.0ed831fd.js";import{n as r,D as s}from"./index.8ae6cd07.js";import"./index.dfdb83b1.js";import"./vendor.194c4086.js";import"./bus.d56574c1.js";const o={};var t=r({name:"modifyReplInfo",data(){return{row:this.dbData,pagerow:{repl_user:"",repl_pass:""},nowRepluser:"",loading:!1,dbrows:[],isValidateName:!1,modifyReplInfoForm:{},modifyReplInfoFormRules:{repl_user:[{required:!0,validator:(e,r,s)=>{if(r){return/\s/.test(r)?s(new Error(this.$t("modifyReplInfo.shuru-buguifan-message"))):s()}return s(new Error(this.$t("modifyReplInfo.qingshuru-shujuku-message")))},trigger:"blur"}],repl_pass:[{required:!0,validator:(e,r,s)=>{if(r){return/\s/.test(r)?s(new Error(this.$t("modifyReplInfo.shuru-buguifan-message"))):s()}return s(new Error(this.$t("modifyReplInfo.qingshuru-shujuku-fuzhi-meassge")))},trigger:"blur"}]}}},props:{dbData:{required:!0}},mounted(){this.pagerow=Object.create(this.row),this.nowRepluser=this.pagerow.repl_user,this.pagerow.repl_pass=s.FromDbText(this.pagerow.repl_pass),this.replInfoList(this.pagerow)},methods:{replInfoList(e){this.modifyReplInfoForm={db_id:e.db_id,repl_user:e.repl_user,repl_pass:s.FromDbText(e.repl_pass)}},saveModifySubmit(){const r=this;this.replInfoList(this.pagerow),this.$refs.modifyReplInfoForm.validate((o=>{if(o){r.loading=!0;let o=Object.assign({},this.modifyReplInfoForm);o.repl_pass=s.ToDbText(o.repl_pass),e.modifyDBReplInfo(o).then((function(){r.loading=!1,r.$message({type:"success",message:r.$t("baseInfo.xiugai-chenggong")}),r.getDBList()}),(function(e){r.loading=!1}))}}))},validateNameFn(r){const s=this;e.getAllDbList().then((function(e){e.rows.find((e=>e.instance_name===r))?s.isValidateName=!0:s.isValidateName=!1}))},getDBList(){const r=this;let s={db_id:r.row.db_id};e.getDbInfo(s).then((function(e){r.loading=!1;const s=e;r.row=e,r.pagerow=$.extend({},r.row),r.nowRepluser=s.repl_user,r.replInfoList(s)}),(function(e){r.loading=!1}))}}},(function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("el-col",{attrs:{span:12}},[s("el-form",{ref:"modifyReplInfoForm",staticStyle:{"margin-top":"20px"},attrs:{model:e.pagerow,rules:e.modifyReplInfoFormRules,"label-width":"140px"}},[s("el-form-item",{attrs:{label:e.$t("modifyReplInfo.DBzhong-fuzhiyonghu"),prop:"repl_user"}},[s("el-input",{model:{value:e.pagerow.repl_user,callback:function(r){e.$set(e.pagerow,"repl_user",r)},expression:"pagerow.repl_user"}})],1),s("el-form-item",{attrs:{label:e.$t("modifyReplInfo.DBzhong-fuzhimima"),prop:"repl_pass"}},[s("el-input",{attrs:{"show-password":""},model:{value:e.pagerow.repl_pass,callback:function(r){e.$set(e.pagerow,"repl_pass",r)},expression:"pagerow.repl_pass"}})],1),s("el-form-item",[s("p",{staticStyle:{color:"red","font-size":"14px"}},[e._v(e._s(e.$t("modifyReplInfo.fuzhiyonghu-yuHAyonghu-message")))]),s("p",{directives:[{name:"show",rawName:"v-show",value:e.row.cluster_id&&1===e.row.cluster_type,expression:"row.cluster_id&&row.cluster_type===1"}],staticStyle:{color:"red","font-size":"14px"}},[e._v(e._s(e.$t("dbPassword.gaishujuku-zailiufuzhi-message"))+" ")]),s("el-button",{staticClass:"main",attrs:{loading:e.loading,disabled:1==e.row.cluster_type||e.nowRepluser!=e.row.db_user&&e.row.db_user==e.pagerow.repl_user},on:{click:e.saveModifySubmit}},[e._v(e._s(e.$t("editConfigTab.baocun-xiugai"))+" ")])],1)],1)],1)}),[],!1,i,"1aa60dfa",null,null);function i(e){for(let r in o)this[r]=o[r]}var a=function(){return t.exports}();export{a as default};
