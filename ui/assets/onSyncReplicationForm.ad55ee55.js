import{A as e}from"./api_dbManage.0ed831fd.js";import{a as n,s as o}from"./staticTools.84335405.js";import{n as i}from"./index.851f4377.js";import"./index.dfdb83b1.js";import"./vendor.194c4086.js";import"./bus.d56574c1.js";const t={};var l=i({data(){return{db_id:"",onSyncReplicationFormVisible:!1,onSyncReplicationForm:{node_id_multiple:[]},onSyncReplicationFormRules:{sync_mode:[{required:!0,message:this.$t("onSyncReplicationForm.qingxuanze-moshi"),trigger:"change"}],sync_method:[{required:!0,message:this.$t("onSyncReplicationForm.qingxuanze-fangfa"),trigger:"change"}],node_id_single:[{required:!0,message:this.$t("onSyncReplicationForm.qingxuanze-beijiedian"),trigger:"change"}],node_number:[{required:!0,message:this.$t("onSyncReplicationForm.qingxuanze-jiedianshu"),trigger:"change"}],node_id_multiple:[{required:!0,message:this.$t("onSyncReplicationForm.qingxuanze-beijiedian"),trigger:"change"}]},modeOptions:["on","remote_apply","remote_write"],methodOptions:["FIRST","ANY"],nodeCountOptions:[],nodeIpOptions:[]}},methods:{submit(){this.$refs.onSyncReplicationForm.validate((i=>{if(i){const{sync_mode:i,sync_method:t,node_number:l,node_id_single:a,node_id_multiple:s}=this.onSyncReplicationForm;let c={db_id:this.db_id,sync_mode:i,sync_method:t};"Single"===t?c.standby_id_list=[a]:(c.node_number=l,c.standby_id_list=s);const r=n(".onSyncReplicationDialog .el-dialog");e.enableStandbySync(c).then((e=>{o(this.$t("onSyncReplicationForm.kaiqi-chenggong")),this.$emit("refresh"),this.closeDialog(),r.close()}),(e=>{r.close()}))}}))},closeDialog(){this.onSyncReplicationFormVisible=!1,this.$emit("update:isShow",this.onSyncReplicationFormVisible)},getInfo(){let o={db_id:this.db_id};const i=n(".onSyncReplicationDialog .el-dialog");e.getChildNode(o).then((e=>{this.nodeCountOptions=e.rows.filter((e=>0===e.db_state)).map(((e,n)=>n+1)),this.nodeIpOptions=e.rows,i.close()}),(e=>{i.close()}))}},props:["is-show","db-id"],mounted(){this.onSyncReplicationFormVisible=this.$props.isShow,this.db_id=this.$props.dbId,this.$nextTick((()=>{this.getInfo()}))}},(function(){var e=this,n=e.$createElement,o=e._self._c||n;return o("el-dialog",{staticClass:"onSyncReplicationDialog",attrs:{"append-to-body":!0,title:e.$t("onSyncReplicationForm.kaiqi-tongbu-t",[e.db_id]),visible:e.onSyncReplicationFormVisible,"close-on-click-modal":!1},on:{close:e.closeDialog,"update:visible":function(n){e.onSyncReplicationFormVisible=n}}},[o("el-form",{ref:"onSyncReplicationForm",attrs:{model:e.onSyncReplicationForm,rules:e.onSyncReplicationFormRules,"label-width":"180px"}},[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:e.$t("onSyncReplicationForm.tongbu-moshi"),prop:"sync_mode"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("onSyncReplicationForm.qingxuanze-moshi")},model:{value:e.onSyncReplicationForm.sync_mode,callback:function(n){e.$set(e.onSyncReplicationForm,"sync_mode",n)},expression:"onSyncReplicationForm.sync_mode"}},e._l(e.modeOptions,(function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:e.$t("onSyncReplicationForm.tongbu-fangfa"),prop:"sync_method"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("onSyncReplicationForm.qingxuanze-fangfa")},model:{value:e.onSyncReplicationForm.sync_method,callback:function(n){e.$set(e.onSyncReplicationForm,"sync_method",n)},expression:"onSyncReplicationForm.sync_method"}},e._l(e.methodOptions,(function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),"Single"===e.onSyncReplicationForm.sync_method?o("el-row",[o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:e.$t("onSyncReplicationForm.xuanze-beijiedian"),prop:"node_id_single"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("onSyncReplicationForm.qingxuanze-beijiedian")},model:{value:e.onSyncReplicationForm.node_id_single,callback:function(n){e.$set(e.onSyncReplicationForm,"node_id_single",n)},expression:"onSyncReplicationForm.node_id_single"}},e._l(e.nodeIpOptions,(function(e){return o("el-option",{key:e.host,attrs:{label:e.host,value:e.db_id}})})),1)],1)],1)],1):e._e(),"FIRST"===e.onSyncReplicationForm.sync_method||"ANY"===e.onSyncReplicationForm.sync_method?o("el-row",[o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:e.$t("onSyncReplicationForm.shezhi-jiedianshu"),prop:"node_number"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("onSyncReplicationForm.qingxuanze-jiedianshu")},model:{value:e.onSyncReplicationForm.node_number,callback:function(n){e.$set(e.onSyncReplicationForm,"node_number",n)},expression:"onSyncReplicationForm.node_number"}},e._l(e.nodeCountOptions,(function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:e.$t("onSyncReplicationForm.xuanze-beijiedian"),prop:"node_id_multiple"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:e.$t("onSyncReplicationForm.qingxuanze-beijiedian")},model:{value:e.onSyncReplicationForm.node_id_multiple,callback:function(n){e.$set(e.onSyncReplicationForm,"node_id_multiple",n)},expression:"onSyncReplicationForm.node_id_multiple"}},e._l(e.nodeIpOptions,(function(n){return o("el-option",{key:n.db_id,attrs:{disabled:0!==n.db_state,label:n.host,value:n.db_id}},[o("el-tooltip",{staticClass:"item",attrs:{disabled:0===n.db_state,"open-delay":"400",effect:"dark",placement:"top",content:e.$t("onSyncReplicationForm.shujuku-zhuangtai-yichang")}},[o("div",[e._v(" "+e._s(n.host)+" ")])])],1)})),1)],1)],1)],1):e._e()],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.closeDialog}},[e._v(e._s(e.$t("index.qu-xiao")))]),o("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v(e._s(e.$t("defineDatabasePage.ti-jiao")))])],1)],1)}),[],!1,a,"657f2142",null,null);function a(e){for(let n in t)this[n]=t[n]}var s=function(){return l.exports}();export{s as default};
