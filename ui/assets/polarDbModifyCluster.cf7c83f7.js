var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,o=(e,o)=>{for(var s in o||(o={}))r.call(o,s)&&i(e,s,o[s]);if(t)for(var s of t(o))a.call(o,s)&&i(e,s,o[s]);return e};"undefined"!=typeof require&&require;import{A as s}from"./api_clusterManage.788b7961.js";import{a as l}from"./staticTools.84335405.js";import{n,D as u}from"./index.8ae6cd07.js";import{b as c,e as d,h as p,c as m}from"./verificationRules.bef90446.js";import{c as g}from"./polarDbComputerRoomConfig.b908c93f.js";import f from"./taskLog.e9bd1119.js";import{b}from"./bus.d56574c1.js";import"./index.dfdb83b1.js";import"./vendor.194c4086.js";const _={};var h=n({name:"clusterInfo",inject:["reload"],data(){return{cluster_type:"",clusterInfoForm:{repl_user:"",db_user:""},clusterInfoFormRules:{polar_hostid:[{required:!0,message:this.$t("polarDbClusterInfo.qingshuru-polar_hostid"),trigger:"blur"}],polar_datadir:[{required:!0,message:this.$t("createPolardbCluster.qingshuru-polar_datadir"),trigger:"blur"}],pfs_disk_name:[{required:!0,message:this.$t("createPolardbCluster.qingshuru-pfs_disk_name"),trigger:"blur"}],cluster_name:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-jiqun-mingcheng"),trigger:"blur"}],vip:[{required:!0,validator:(e,t,r)=>{if(t){let e=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,a=t.split(",");for(let t in a)if(!1===e.test(a[t]))return r(new Error(this.$t("verificationRules.IP-dizhi-buguifan-message")));return r()}return r(new Error(this.$t("verificationRules.qingshuru-IP-dizhi")))},trigger:"blur"}],port:[{required:!0,validator:c,trigger:"blur"},{required:!0,validator:(e,t,r)=>{if(""==this.clusterInfoForm.port)return r();if(this.loading_port=!0,this.savePort==t)return this.loading_port=!1,r();{let e=[];for(let r=0;r<this.clusterInfoForm.host_list.length;r++){let a={host:this.clusterInfoForm.host_list[r],port:t};e.push(a)}Promise.all(e.map((e=>s.checkPortIsUsed(e)))).then((e=>{console.log(e),e.forEach(((t,a)=>(this.loading_port=!1,0!=t.err_code?r(new Error(new Error(e.err_msg))):0==t.is_used&&a==e.length-1?r():1==t.is_used?r(new Error(this.$t("verificationRules.gaiduankou-yibei-m"))):void 0)))}),(e=>(this.loading_port=!1,r(new Error(this.$t("verificationRules.jiancha-qingqiu-chucuo"))))))}},trigger:"blur"}],pgdata:[{required:!0,message:this.$t("verificationRules.qingshuru-shuji-mulu"),trigger:"blur"}],db_pass:[{required:!0,message:this.$t("defineDatabasePage.DB-zhongde-mima-placeholder"),trigger:"blur"}],repl_user:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-liufuzhi-yonghu"),trigger:"blur"}],repl_pass:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-liufuzhi-yonghude-mima"),trigger:"blur"}],db_ip_list:[{required:!0,validator:d,trigger:"blur"}],repl_ip_list:[{required:!0,validator:d,trigger:"blur"}],cstlb_list:[{required:!1,validator:p,trigger:"blur"}],probe_db_name:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-DB"),trigger:"blur"}],probe_interval:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-zhouqi-miao"),trigger:"blur"}],probe_timeout:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-chaoshi-miao"),trigger:"blur"}],probe_retry_cnt:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tanceshibai-message"),trigger:"blur"}],probe_retry_interval:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-shibaihou-message"),trigger:"blur"}],probe_pri_sql:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-zhuku-SQL"),trigger:"blur"}],probe_stb_sql:[{required:!0,message:this.$t("createStreamReplicationCluster.qingshuru-tance-beiku-SQL"),trigger:"blur"}]},clusterState:this.$queryProps.cluster_state,language:"",loading_port:!1,savePort:""}},watch:{"clusterInfoForm.repl_user":{handler(e,t){e==this.clusterInfoForm.db_user&&(this.clusterInfoForm.repl_pass=this.clusterInfoForm.db_pass)}},"clusterInfoForm.db_user":{handler(e,t){e==this.clusterInfoForm.repl_user&&(this.clusterInfoForm.repl_pass=this.clusterInfoForm.db_pass)}}},methods:{showList:function(){let e=this;e.loading=!0;let t={cluster_id:this.$queryProps.cluster_id};s.getClusterDetail(t).then((function(t){e.loading=!1,e.cluster_type=t.cluster_type,e.clusterInfoForm=t,e.savePort=t.port,e.clusterInfoForm.db_pass=u.FromDbText(t.db_pass),e.clusterInfoForm.repl_pass=u.FromDbText(t.repl_pass)}),(function(t){e.loading=!1}))},saveChangesSubmit:function(){let e=this;this.$refs.clusterInfoForm.validate((t=>{if(t){e.loading=!0;let t=Object.assign({},this.clusterInfoForm);t.db_pass=u.ToDbText(t.db_pass),t.repl_pass=u.ToDbText(t.repl_pass),t.db_user==t.repl_user&&(t.repl_pass=t.db_pass);let r=JSON.parse(JSON.stringify(e.$route.query));r.cluster_name=t.cluster_name,e.$router.replace({query:r}),s.modifyPolarClusterInfo(t).then((function(t){e.loading=!1,e.$refs.clusterInfoForm.resetFields(),e.showList(),e.$message.success({showClose:!0,message:e.$t("baseInfo.xiugai-chenggong"),duration:1500})}),(function(t){e.loading=!1}))}}))}},mounted:function(){this.cluster_type=this.$queryProps.cluster_type,this.showList(),this.language=localStorage.getItem("language_clup")}},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"clusterInfoForm",staticStyle:{width:"90%","margin-bottom":"100px","margin-top":"20px"},attrs:{model:e.clusterInfoForm,"label-width":"en"==e.language?"160px":"140px",rules:e.clusterInfoFormRules}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("dbList.jiqun-id"),prop:"cluster_id"}},[r("el-input",{attrs:{readonly:!0},model:{value:e.clusterInfoForm.cluster_id,callback:function(t){e.$set(e.clusterInfoForm,"cluster_id",t)},expression:"clusterInfoForm.cluster_id"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("clusterDefine.jiqun-mingcheng"),prop:"cluster_name"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.cluster_name=t.target.value.trim()}},model:{value:e.clusterInfoForm.cluster_name,callback:function(t){e.$set(e.clusterInfoForm,"cluster_name",t)},expression:"clusterInfoForm.cluster_name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("importPatroniCluster.jiqun-VIP"),prop:"vip"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.vip=t.target.value.trim()}},model:{value:e.clusterInfoForm.vip,callback:function(t){e.$set(e.clusterInfoForm,"vip",t)},expression:"clusterInfoForm.vip"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_port,expression:"loading_port"}],attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0)",label:e.$t("defineDatabasePage.shuju-duankou"),prop:"port"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.port=t.target.value.trim()}},model:{value:e.clusterInfoForm.port,callback:function(t){e.$set(e.clusterInfoForm,"port",t)},expression:"clusterInfoForm.port"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("defineDatabasePage.DB-zhongde-yonghu"),prop:"db_user"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.db_user=t.target.value.trim()}},model:{value:e.clusterInfoForm.db_user,callback:function(t){e.$set(e.clusterInfoForm,"db_user",t)},expression:"clusterInfoForm.db_user"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("defineDatabasePage.DB-zhongde-mima"),prop:"db_pass"}},[r("el-input",{attrs:{"show-password":"",readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.db_pass=t.target.value.trim()}},model:{value:e.clusterInfoForm.db_pass,callback:function(t){e.$set(e.clusterInfoForm,"db_pass",t)},expression:"clusterInfoForm.db_pass"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:this.$t("createStandbyPage.liufuzhi-yonghu"),prop:"repl_user"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.repl_user=t.target.value.trim()}},model:{value:e.clusterInfoForm.repl_user,callback:function(t){e.$set(e.clusterInfoForm,"repl_user",t)},expression:"clusterInfoForm.repl_user"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("createStandbyPage.liufuzhi-mima"),prop:"repl_pass"}},[r("el-input",{attrs:{disabled:e.clusterInfoForm.db_user==e.clusterInfoForm.repl_user,"show-password":"",readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.repl_pass=t.target.value.trim()}},model:{value:e.clusterInfoForm.repl_pass,callback:function(t){e.$set(e.clusterInfoForm,"repl_pass",t)},expression:"clusterInfoForm.repl_pass"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"pfsdaemon_params",prop:"pfsdaemon_params"}},[r("el-input",{attrs:{placeholder:e.$t("createPolardbCluster.qingshuru-pfsdaemon_parms")},on:{blur:function(t){e.clusterInfoForm.pfsdaemon_params=t.target.value.trim()}},model:{value:e.clusterInfoForm.pfsdaemon_params,callback:function(t){e.$set(e.clusterInfoForm,"pfsdaemon_params",t)},expression:"clusterInfoForm.pfsdaemon_params"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"next_polar_hostid",prop:"polar_hostid"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.polar_hostid=t.target.value.trim()}},model:{value:e.clusterInfoForm.polar_hostid,callback:function(t){e.$set(e.clusterInfoForm,"polar_hostid",t)},expression:"clusterInfoForm.polar_hostid"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"pfs_disk_name",prop:"pfs_disk_name"}},[r("el-input",{attrs:{placeholder:e.$t("createPolardbCluster.qingshuru-pfs_disk_name"),disabled:""},on:{blur:function(t){e.clusterInfoForm.pfs_disk_name=t.target.value.trim()}},model:{value:e.clusterInfoForm.pfs_disk_name,callback:function(t){e.$set(e.clusterInfoForm,"pfs_disk_name",t)},expression:"clusterInfoForm.pfs_disk_name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"polar_datadir",prop:"polar_datadir"}},[r("el-input",{attrs:{placeholder:e.$t("createPolardbCluster.qingshuru-polar_datadir"),disabled:""},on:{blur:function(t){e.clusterInfoForm.polar_datadir=t.target.value.trim()}},model:{value:e.clusterInfoForm.polar_datadir,callback:function(t){e.$set(e.clusterInfoForm,"polar_datadir",t)},expression:"clusterInfoForm.polar_datadir"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("clusterInfo.tancce-DB-mingcheng"),prop:"probe_db_name"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.probe_db_name=t.target.value.trim()}},model:{value:e.clusterInfoForm.probe_db_name,callback:function(t){e.$set(e.clusterInfoForm,"probe_db_name",t)},expression:"clusterInfoForm.probe_db_name"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-zhouqi-miao"),prop:"probe_interval"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},model:{value:e.clusterInfoForm.probe_interval,callback:function(t){e.$set(e.clusterInfoForm,"probe_interval",t)},expression:"clusterInfoForm.probe_interval"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-chaoshi-miao"),prop:"probe_timeout"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},model:{value:e.clusterInfoForm.probe_timeout,callback:function(t){e.$set(e.clusterInfoForm,"probe_timeout",t)},expression:"clusterInfoForm.probe_timeout"}})],1)],1),r("el-col",{attrs:{span:"en"==e.language?12:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-chongshi-cishu"),prop:"probe_retry_cnt"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.qingshuru-tanceshibai-message")}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},model:{value:e.clusterInfoForm.probe_retry_cnt,callback:function(t){e.$set(e.clusterInfoForm,"probe_retry_cnt",t)},expression:"clusterInfoForm.probe_retry_cnt"}})],1)],1)],1),r("el-col",{attrs:{span:"en"==e.language?12:8}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.chongshi-jiange-miao"),prop:"probe_retry_interval"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createPolardbCluster.qingshuru-tanceshibaihou-message")}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},model:{value:e.clusterInfoForm.probe_retry_interval,callback:function(t){e.$set(e.clusterInfoForm,"probe_retry_interval",t)},expression:"clusterInfoForm.probe_retry_interval"}})],1)],1)],1)],1),r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-zhuku-SQL"),prop:"probe_pri_sql"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.probe_pri_sql=t.target.value.trim()}},model:{value:e.clusterInfoForm.probe_pri_sql,callback:function(t){e.$set(e.clusterInfoForm,"probe_pri_sql",t)},expression:"clusterInfoForm.probe_pri_sql"}})],1),r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.tance-beiku-SQL"),prop:"probe_stb_sql"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.probe_stb_sql=t.target.value.trim()}},model:{value:e.clusterInfoForm.probe_stb_sql,callback:function(t){e.$set(e.clusterInfoForm,"probe_stb_sql",t)},expression:"clusterInfoForm.probe_stb_sql"}})],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.chufa-DBmingcheng"),prop:"trigger_db_name"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.trigger_db_name=t.target.value.trim()}},model:{value:e.clusterInfoForm.trigger_db_name,callback:function(t){e.$set(e.clusterInfoForm,"trigger_db_name",t)},expression:"clusterInfoForm.trigger_db_name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.chufa-DBhanshu"),prop:"trigger_db_func"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.trigger_db_func=t.target.value.trim()}},model:{value:e.clusterInfoForm.trigger_db_func,callback:function(t){e.$set(e.clusterInfoForm,"trigger_db_func",t)},expression:"clusterInfoForm.trigger_db_func"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{"label-width":"en"==e.language?"310px":"",label:e.$t("createStreamReplicationCluster.shifou-zidong-jiahui-jiqun"),prop:"auto_failback"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createStreamReplicationCluster.beikuguzhang-message"),placement:"top-end"}},[r("el-select",{attrs:{disabled:0!=e.clusterState&&-1!=e.clusterState,placeholder:e.$t("createDatabasePage.qing-xuan-ze")},model:{value:e.clusterInfoForm.auto_failback,callback:function(t){e.$set(e.clusterInfoForm,"auto_failback",t)},expression:"clusterInfoForm.auto_failback"}},[r("el-option",{attrs:{label:e.$t("dbList.shi"),value:!0}}),r("el-option",{attrs:{label:e.$t("dbList.fou"),value:!1}})],1)],1)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{"label-width":"en"==e.language?"310px":"",label:e.$t("importPolardbCluster.kuazhan-qiehuan-baoliu-jiuzhanvip"),prop:"save_old_room_vip"}},[r("el-select",{attrs:{placeholder:e.$t("createDatabasePage.qing-xuan-ze")},model:{value:e.clusterInfoForm.save_old_room_vip,callback:function(t){e.$set(e.clusterInfoForm,"save_old_room_vip",t)},expression:"clusterInfoForm.save_old_room_vip"}},[r("el-option",{attrs:{label:e.$t("dbList.shi"),value:!0}}),r("el-option",{attrs:{label:e.$t("dbList.fou"),value:!1}})],1)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{"label-width":"en"==e.language?"310px":"",label:e.$t("createPolardbCluster.hulue-reset-zhixingjieguo"),prop:"ignore_reset_cmd_return_code"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createPolardbCluster.zaijiqun-xiufu-guochengzhong-message"),placement:"top-end"}},[r("el-select",{attrs:{filterable:"",placeholder:e.$t("createDatabasePage.qing-xuan-ze")},model:{value:e.clusterInfoForm.ignore_reset_cmd_return_code,callback:function(t){e.$set(e.clusterInfoForm,"ignore_reset_cmd_return_code",t)},expression:"clusterInfoForm.ignore_reset_cmd_return_code"}},[r("el-option",{attrs:{label:e.$t("dbList.shi"),value:1}}),r("el-option",{attrs:{label:e.$t("dbList.fou"),value:0}})],1)],1)],1)],1)],1),r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.bei-zhu"),prop:"remark"}},[r("el-input",{attrs:{readonly:0!=e.clusterState&&-1!=e.clusterState&&"readonly"},on:{blur:function(t){e.clusterInfoForm.remark=t.target.value.trim()}},model:{value:e.clusterInfoForm.remark,callback:function(t){e.$set(e.clusterInfoForm,"remark",t)},expression:"clusterInfoForm.remark"}})],1),r("el-form-item",[0===e.clusterState||-1===e.clusterState?r("p",{staticStyle:{color:"red","font-size":"14px"}},[e._v(" "+e._s(e.$t("clusterInfo.jinggao-xiugaijiqun-message")))]):e._e()]),r("el-form-item",[0===e.clusterState||-1===e.clusterState?r("el-button",{attrs:{type:"primary"},on:{click:e.saveChangesSubmit}},[e._v(e._s(e.$t("editConfigTab.baocun-xiugai"))+" ")]):e._e()],1)],1)}),[],!1,$,"195f5598",null,null);function $(e){for(let t in _)this[t]=_[t]}var v=function(){return h.exports}();const w={};var F=n({name:"dbList",components:{},data(){return{initialQueryParmsObj:{},loading_pgdata:!1,clusterState:this.$route.query.cluster_state,rows:[],total:0,page:1,size:20,olapage:1,roomList:[],upDbList:[],loading:!1,currentRow:"",editFormVisible:!1,editFormRules:{host:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-shujuku-suozai-message"),trigger:"blur"},{required:!0,validator:d,trigger:"blur"}],up_db_id:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-shujukude-shangyiji-zhuku"),trigger:"blur"}],repl_ip:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-shujuku-liufuzhi-message"),trigger:"blur"},{required:!0,validator:d,trigger:"blur"}],pgdata:[{required:!0,message:this.$t("defineDatabasePage.shuju-mulu-placeholder"),trigger:"blur"},{required:!0,validator:m,trigger:"blur"},{required:!0,validator:(e,t,r)=>{if(""===t)r(new Error(this.$t("verificationRules.qingshuru-shuji-mulu")));else{if(this.currentRow.pgdata==t&&this.currentRow.host==this.editForm.host)return r();{let e={host:this.editForm.host,pgdata:t};this.loading_pgdata=!0,s.checkPgdataIsUsed(e).then((e=>(this.loading_pgdata=!1,0==e.used||(1==e.used?r(new Error(this.$t("verificationRules.gaishuju-mulu-m"))):void 0))),(e=>(this.loading_pgdata=!1,r(new Error(this.$t("verificationRules.jiancha-qingqiu-chucuo")))))).then((t=>{1==t&&s.checkTheDirIsEmpty(e).then((e=>1==e.is_empty?r(new Error(this.$t("verificationRules.mulubucunzai-huoweikong"))):0==e.is_empty?r():r(new Error(e.err_msg))),(e=>r(new Error(this.$t("verificationRules.jiancha-qingqiu-chucuo")))))}))}}},trigger:"submit"}],repl_app_name:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-lianjiede-application_name"),trigger:"blur"}],scores:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-shujukude-qiehuan-youxianji"),trigger:"blur"},{type:"number",message:this.$t("createStreamReplicationCluster.youxianji-bixuwei-shuzi")}],reset_cmd:[{required:!0,message:this.$t("createPolardbCluster.qingshuru-fangnaolie-reset-mingling"),trigger:"blur"}]},editForm:{},clupBtn:["import","create","distribution","del","standby","active","switch","stop","start","edit","create","restart","change","cancel","kill","cancel","kill","detail","create","import","del","standby","edit","see","offLine","onLine","detail","detail","plan","backup","detail","del","edit","import","del","detail","log","recovery","log","monitor","open","start","edit","del","add","edit","del","see","edit","offLine","edit","host","database","session","lock","modify","move","upgrade","bounce"],language:""}},watch:{"editForm.is_rewind":function(e){e||(this.editForm.is_rebuild=!1)},"editForm.is_rebuild":function(e){e&&(this.editForm.is_rewind=!0)}},computed:{addFormPort(){var e;return null==(e=this.upDbList.find((e=>e.db_id==this.addForm.up_db_id)))?void 0:e.port}},methods:{blurIpListFunc(){},funChandleClick:function(e){const t=this;let r="",a=window.location.href.split("?")[1],i=new URLSearchParams(a);i.has("hidmenu")&&(r=i.get("hidmenu")),"conversation"==e.type?t.wantConversationBtn(e.row,r):"lock"==e.type&&t.wantLockBtn(e.row,r)},wantConversationBtn:function(e,t){this.$router.push({path:"/SessionManage",query:o({data:e},""!=t&&{hidmenu:t})})},wantLockBtn:function(e,t){this.$router.push({path:"/lockManage",query:o({data:e},""!=t&&{hidmenu:t})})},composeValue:(e,t,r)=>({type:e,index:t,row:r}),tableRowClassName:({row:e,rowIndex:t})=>t%2!=0?"warning-row":"success-row",handleSizeChange(e){this.size=e,this.oldpage=this.page,this.showdbList()},handleCurrentChange(e){this.page=e,this.oldpage=this.page,this.showdbList()},showdbList:function(){let e=this;e.loading=!0;let t={page_size:e.$route.query.page_size,page_num:e.$route.query.page_num,cluster_id:e.$route.query.cluster_id};s.getdbList(t).then((function(t){e.loading=!1,t&&t.rows&&(e.total=t.total,e.rows=t.rows,null!=e.$refs.pagination&&(e.$refs.pagination.internalCurrentPage=e.oldpage)),e.$nextTick((()=>{let t=window.location.href.split("?")[1],r=new URLSearchParams(t);if(r.has("hidmenu")){let t=r.get("hidmenu").split(","),a=e.clupBtn.filter((e=>t.indexOf(e)<0));for(let e=0;e<a.length;e++){let t=document.getElementsByClassName(""+a[e]);for(let e=0;e<t.length;e++)t[e].setAttribute("style","display:none")}}}))}),(function(t){e.loading=!1}))},showEditDialog:function(e,t){const r=this;let a={cluster_id:r.$route.query.cluster_id},i={page_size:1e4,page_num:1,cluster_id:r.$route.query.cluster_id};const o=l(".modifyDialog .el-dialog");r.editFormVisible=!0,s.getdbList(i).then((function(e){e&&e.rows&&(r.upDbList=e.rows),s.getSrClusterRoomInfo(a).then((function(e){r.roomList=e,r.currentRow=t,o.close(),r.editForm=Object.assign({},t),null==r.editForm.scores&&(r.editForm.scores=0)}),(function(e){o.close(),r.editFormVisible=!1}))}),(function(e){o.close(),r.editFormVisible=!1}))},editFormSubmit:function(){let e=this;this.$refs.editForm.validate((t=>{if(t){const t=l(".modifyDialog .el-dialog");let r={cluster_id:e.currentRow.cluster_id,db_id:e.currentRow.db_id};r.room_id=e.editForm.room_id,e.editForm.host!==e.currentRow.host&&(r.host=e.editForm.host),e.editForm.repl_ip!==e.currentRow.repl_ip&&(r.repl_ip=e.editForm.repl_ip),e.editForm.scores!==e.currentRow.scores&&(r.scores=e.editForm.scores),e.editForm.pgdata!==e.currentRow.pgdata&&(r.pgdata=e.editForm.pgdata),e.editForm.up_db_id!==e.currentRow.up_db_id&&(r.up_db_id=e.editForm.up_db_id),e.editForm.repl_app_name!==e.currentRow.repl_app_name&&(r.repl_app_name=e.editForm.repl_app_name),e.editForm.reset_cmd!==e.currentRow.reset_cmd&&(r.reset_cmd=e.editForm.reset_cmd),null!=e.editForm.is_rebuild&&(r.is_rebuild=e.editForm.is_rebuild),null!=e.editForm.rm_pgdata&&(r.rm_pgdata=e.editForm.rm_pgdata),null!=e.editForm.is_rewind&&(r.is_rewind=e.editForm.is_rewind),s.edit(r).then((function(){t.close(),e.$refs.editForm.resetFields(),e.editFormVisible=!1,e.showdbList()}),(function(e){t.close()}))}}))},deldbList:function(e,t){let r=this;this.$confirm(r.$t("polarDbEditDBList.cicaozuodian-cunzaifengxian-message"),r.$t("polarDbEditDBList.jing-gao"),{type:"warning",closeOnClickModal:!1}).then((()=>{r.loading=!0;let e={cluster_id:t.cluster_id,db_id:t.db_id};s.deletedbList(e).then((function(){r.loading=!1;let e=Math.ceil((r.total-1)/r.size),t=r.page>e?e:r.page;r.page=t<1?1:t,r.showdbList()}),(function(e){r.loading=!1}))})).catch((()=>{}))}},mounted:function(){this.showdbList(),this.language=localStorage.getItem("language_clup"),this.initialQueryParmsObj=this.$route.query},destroyed(){clearInterval(this.intervalID)}},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",[r("el-col",[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"row-class-name":e.tableRowClassName,data:e.rows,border:"","element-loading-text":e.$t("Public.ping-ming-jia-zai-zhong")}},[r("el-table-column",{attrs:{prop:"db_id",label:e.$t("switchDatabasePage.shujuku-ID"),align:"center",width:"120px"}}),r("el-table-column",{attrs:{prop:"up_db_id",label:e.$t("polarDbEditDBList.shangji-zhuku"),align:"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[2!==t.row.state?r("span",[e._v(" "+e._s(t.row.up_db_id)+" ")]):e._e(),2==t.row.state?r("del",{staticStyle:{"text-decoration":"line-through",color:"#000"}},[r("span",{staticStyle:{color:"#9a9a9a"}},[e._v(" "+e._s(t.row.up_db_id)+" ")])]):e._e()]}}])}),r("el-table-column",{attrs:{prop:"state",label:e.$t("polarDbEditDBList.HA-zhuangtai"),align:"left","header-align":"center",width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.state?r("i",{staticClass:"el-icon-s-flag green"},[r("span",{staticClass:"statefont"},[e._v(" Normal")])]):2===t.row.state?r("i",{staticClass:"el-icon-error red"},[r("span",{staticClass:"statefont"},[e._v(" Fault")])]):3===t.row.state?r("span",[r("i",{staticClass:"el-icon-loading orange"}),e._v(" "),r("span",{staticClass:"statefont"},[e._v(" Failover")])]):4===t.row.state?r("span",[r("i",{staticClass:"el-icon-loading black"}),r("span",{staticClass:"statefont"},[e._v(" Switching")])]):5===t.row.state?r("span",[r("i",{staticClass:"el-icon-loading green"}),e._v(" "),r("span",{staticClass:"statefont"},[e._v(" Repairing")])]):e._e()]}}])}),r("el-table-column",{attrs:{prop:"polar_type",label:e.$t("dbList.zhu-bei-ku"),align:"center",width:"140px"}}),r("el-table-column",{attrs:{prop:"host",label:e.$t("replDelay.suozai-zhuji"),align:"center",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-dropdown",{attrs:{trigger:"click"},on:{command:e.funChandleClick}},[r("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#0070cc","font-weight":"500"}},[e._v(" "+e._s(t.row.host)),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:e.composeValue("conversation",t.$index,t.row)}},[e._v(e._s(e.$t("dbList.huihua-jiankong")))]),r("el-dropdown-item",{attrs:{command:e.composeValue("lock",t.$index,t.row)}},[e._v(e._s(e.$t("dbList.suo-guan-li")))])],1)],1)]}}])}),r("el-table-column",{attrs:{prop:"repl_ip",label:e.$t("polarDbEditDBList.liufuzhi-IP"),align:"center",width:"140px"}}),r("el-table-column",{attrs:{prop:"room_name",label:e.$t("dbList.jifang-mingcheng"),align:"center",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"statefont"},[e._v(" "+e._s("默认机房"==t.row.room_name?e.$t("dbList.moren-jifang"):t.row.room_name))])]}}])}),r("el-table-column",{attrs:{prop:"pgdata",label:e.$t("defineDatabasePage.shuju-mulu"),align:"center","header-align":"center","min-width":"160px","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"scores",label:e.$t("createStreamReplicationCluster.youxianji"),align:"center","header-align":"center","min-width":"60px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(" "+e._s(null==t.row.scores?"0":t.row.scores))])]}}])}),r("el-table-column",{attrs:{prop:"db_state",label:e.$t("dbList.zhuang-tai"),align:"left","header-align":"center",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.db_state?r("span",[r("i",{staticClass:"el-icon-loading"}),r("span",{staticClass:"statefont"},[e._v(" "+e._s(e.$t("dbList.chuang-jian-zhong")))])]):e._e(),0===t.row.db_state?r("i",{staticClass:"el-icon-success green"},[r("span",{staticClass:"statefont"},[e._v(" "+e._s(e.$t("dbList.yun-xing-zhong")))])]):1===t.row.db_state?r("i",{staticClass:"el-icon-info"},[r("span",{staticClass:"statefont"},[e._v(" "+e._s(e.$t("dbList.ting-zhi")))])]):-1===t.row.db_state?r("i",{staticClass:"el-icon-warning orange"},[r("span",{staticClass:"statefont"},[e._v(" "+e._s(e.$t("dbList.agent-yichang")))])]):e._e()]}}])}),r("el-table-column",{attrs:{prop:"handle",label:e.$t("clusterDefine.caozuo"),align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==e.clusterState||-1==e.clusterState?r("span",[r("el-link",{staticClass:"normal modify",on:{click:function(r){return e.showEditDialog(t.$index,t.row)}}},[e._v(e._s(e.$t("alarmSet.xiugai")))]),1!==t.row.is_primary?r("el-link",{staticClass:"normal move",on:{click:function(r){return e.deldbList(t.$index,t.row)}}},[e._v(e._s(e.$t("alarmInformationConfig.yichu")))]):e._e()],1):e._e()]}}])})],1),r("div",{staticClass:"block",staticStyle:{float:"right"}},[r("el-pagination",{ref:"pagination",attrs:{layout:"total, sizes, prev, pager, next, jumper",total:e.total,"page-sizes":[20,30,40,50,100]},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"modifyDialog",attrs:{title:e.$t("alarmSet.xiugai"),"append-to-body":!0,visible:e.editFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editFormVisible=t}}},[r("el-form",{ref:"editForm",staticStyle:{width:"90%"},attrs:{model:e.editForm,"label-width":"en"==e.language?"190px":"120px",rules:e.editFormRules}},[r("el-form-item",{attrs:{label:e.$t("dbList.jiqun-id"),prop:"cluster_id"}},[r("el-input",{attrs:{readonly:""},model:{value:e.editForm.cluster_id,callback:function(t){e.$set(e.editForm,"cluster_id",t)},expression:"editForm.cluster_id"}})],1),r("el-form-item",{attrs:{label:e.$t("switchDatabasePage.shujuku-ID"),prop:"db_id"}},[r("el-input",{model:{value:e.editForm.db_id,callback:function(t){e.$set(e.editForm,"db_id",t)},expression:"editForm.db_id"}})],1),r("el-form-item",{attrs:{label:e.$t("createStreamReplicationCluster.youxianji"),prop:"scores"}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("polarDbEditDBList.youxainji-dec"),placement:"top-start"}},[r("el-input",{model:{value:e.editForm.scores,callback:function(t){e.$set(e.editForm,"scores",e._n(t))},expression:"editForm.scores"}})],1)],1),r("el-form-item",{attrs:{label:e.$t("replDelay.suozai-zhuji"),prop:"host"}},[r("el-input",{model:{value:e.editForm.host,callback:function(t){e.$set(e.editForm,"host",t)},expression:"editForm.host"}})],1),0==e.editForm.is_primary?r("el-form-item",{attrs:{label:e.$t("polarDbEditDBList.shangji-zhuku-ID"),prop:"up_db_id"}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("polarDbEditDBList.gaicaozuo-buhuixiugai-message"),placement:"top-start"}},[r("el-select",{attrs:{placeholder:e.$t("createDatabasePage.qing-xuan-ze")},model:{value:e.editForm.up_db_id,callback:function(t){e.$set(e.editForm,"up_db_id",t)},expression:"editForm.up_db_id"}},e._l(e.upDbList,(function(t,a){return r("el-option",{key:a,attrs:{disabled:t.host==e.editForm.host,label:t.host+":"+t.port,value:t.db_id}})})),1)],1)],1):e._e(),r("el-form-item",{attrs:{label:"application_name",prop:"repl_app_name"}},[r("el-input",{model:{value:e.editForm.repl_app_name,callback:function(t){e.$set(e.editForm,"repl_app_name",t)},expression:"editForm.repl_app_name"}})],1),r("el-form-item",{attrs:{label:e.$t("polarDbEditDBList.liufuzhi-IP"),prop:"repl_ip"}},[r("el-input",{model:{value:e.editForm.repl_ip,callback:function(t){e.$set(e.editForm,"repl_ip",t)},expression:"editForm.repl_ip"}})],1),r("el-form-item",{directives:[{name:"loading",rawName:"v-loading",value:e.loading_pgdata,expression:"loading_pgdata"}],attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0)",label:e.$t("defineDatabasePage.shuju-mulu"),prop:"pgdata"}},[r("el-input",{model:{value:e.editForm.pgdata,callback:function(t){e.$set(e.editForm,"pgdata",t)},expression:"editForm.pgdata"}})],1),r("el-row",[r("el-col",{attrs:{span:23}},[r("el-form-item",{attrs:{label:e.$t("createPolardbCluster.fangnaolie-reset-mingling"),prop:"reset_cmd"}},[r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("createPolardbCluster.qingshuru-fangnaolie-message"),placement:"top-start"}},[r("el-input",{attrs:{placeholder:e.$t("createPolardbCluster.qingshuru-fangnaolie-message")},on:{blur:function(t){e.editForm.reset_cmd=t.target.value.trim()}},model:{value:e.editForm.reset_cmd,callback:function(t){e.$set(e.editForm,"reset_cmd",e._n(t))},expression:"editForm.reset_cmd"}})],1)],1)],1),r("el-col",{attrs:{span:1}},[r("div",{staticStyle:{"margin-left":"5px",height:"20px","padding-top":"8px"}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[r("div",{staticStyle:{"overflow-y":"auto","white-space":"pre-wrap"},attrs:{slot:"content"},slot:"content"},[r("pre",[e._v(e._s(e.$t("createPolardbCluster.fangnaolie-question")))])]),r("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"5px"}}),r("i",{staticClass:"el-icon-question"})])],1)])],1),r("el-form-item",{attrs:{label:e.$t("polarDbEditDBList.suozai-jifang"),prop:"room_id"}},[r("el-select",{attrs:{placeholder:e.$t("createDatabasePage.qing-xuan-ze")},model:{value:e.editForm.room_id,callback:function(t){e.$set(e.editForm,"room_id",t)},expression:"editForm.room_id"}},e._l(e.roomList,(function(t,a){return r("el-option",{key:a,attrs:{label:"默认机房"==t.room_name?e.$t("dbList.moren-jifang"):t.room_name,value:t.room_id}})})),1)],1),r("div",{staticStyle:{"text-align":"center",color:"#282828"}},[r("el-divider",{attrs:{"content-position":"center"}},[e._v(e._s(e.$t("polarDbEditDBList.guzhanghou-zidongjiahui-message")))])],1),r("el-form-item",{attrs:{label:"pg_rewind",prop:"is_rewind"}},[r("el-checkbox",{model:{value:e.editForm.is_rewind,callback:function(t){e.$set(e.editForm,"is_rewind",t)},expression:"editForm.is_rewind"}}),r("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:e.$t("polarDbEditDBList.shiyong-pg_rewind-huifu-message"),placement:"top-start"}},[r("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"10px",color:"#afaeae"}})])],1),r("el-form-item",{attrs:{label:e.$t("polarDbEditDBList.chongxindajian-beiku")}},[r("el-checkbox",{model:{value:e.editForm.is_rebuild,callback:function(t){e.$set(e.editForm,"is_rebuild",t)},expression:"editForm.is_rebuild"}}),e.editForm.is_rebuild?r("div",{staticStyle:{"margin-left":"20px","font-size":"14px",display:"inline-block"}},[r("el-radio",{attrs:{label:0},model:{value:e.editForm.rm_pgdata,callback:function(t){e.$set(e.editForm,"rm_pgdata",t)},expression:"editForm.rm_pgdata"}},[e._v(e._s(e.$t("polarDbEditDBList.chongmingming-jiude-shujuku")))]),r("el-radio",{staticStyle:{"margin-right":"80px"},attrs:{label:1},model:{value:e.editForm.rm_pgdata,callback:function(t){e.$set(e.editForm,"rm_pgdata",t)},expression:"editForm.rm_pgdata"}},[e._v(e._s(e.$t("polarDbEditDBList.shanchu-yuanyou-shujumulu"))+" ")])],1):e._e()],1),r("el-form-item",[r("p",{staticStyle:{color:"red","font-size":"14px"}},[e._v(" "+e._s(e.$t("baseInfo.jinggao-xiugai-shili-warning-m")))])])],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v(e._s(e.$t("index.qu-xiao")))]),r("el-button",{attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(t){return e.editFormSubmit(t)}}},[e._v(e._s(e.$t("defineDatabasePage.ti-jiao")))])],1)],1)],1)],1)}),[],!1,y,"4fe140ef",null,null);function y(e){for(let t in w)this[t]=w[t]}var I=function(){return F.exports}();const S={};var x=n({name:"dbList",inject:["reload"],components:{taskLog:f},data:()=>({rows:[],total:0,page:1,size:20,oldpage:1,loading:!1}),methods:{tableRowClassName:({row:e,rowIndex:t})=>t%2!=0?"warning-row":"success-row",handleSizeChange(e){this.size=e,this.oldpage=this.page,this.showHostList()},handleCurrentChange(e){this.page=e,this.oldpage=this.page,this.showHostList()},showHostList:function(){let e=this;e.loading=!0;let t={page_size:e.$route.query.page_size,page_num:e.$route.query.page_num,cluster_id:e.$route.query.cluster_id};s.getHostList(t).then((function(t){e.loading=!1,t&&t.rows&&(e.total=t.total,e.rows=t.rows,null!=e.$refs.pagination&&(e.$refs.pagination.internalCurrentPage=e.oldpage))}),(function(t){e.loading=!1}))},SdClusterSwitch:function(e,t){let r=this;this.$confirm(r.$t("polarDbEditHostList.ninqueding-yaojiangshujuku-qiehuandao-zhuji")+t.ip+r.$t("polarDbEditHostList.yunxingma-message"),r.$t("index.ti-shi"),{type:"warning",closeOnClickModal:!1}).then((()=>{r.loading=!0;let e={cluster_id:t.cluster_id,ip:t.ip};s.sdSwitch(e).then((function(e){r.loading=!1,r.$refs.tasklog.openDialog(e.task_id,r.showHostList,2),r.showHostList()}),(function(e){r.loading=!1}))})).catch((e=>{}))}},mounted:function(){this.showHostList()}},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-row",[r("el-col",[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{"row-class-name":e.tableRowClassName,data:e.rows,border:"","element-loading-text":e.$t("Public.ping-ming-jia-zai-zhong")}},[r("el-table-column",{attrs:{prop:"db_state",label:e.$t("polarDbEditHostList.DB-zhuangtai"),align:"center","min-width":"80px"}}),r("el-table-column",{attrs:{prop:"vip_state",label:e.$t("polarDbEditHostList.VIP-zhuangtai"),align:"center","min-width":"80px"}}),r("el-table-column",{attrs:{prop:"is_primary",label:e.$t("dashboard.zhu-bei"),align:"center","min-width":"80px"}}),r("el-table-column",{attrs:{prop:"ip",label:e.$t("polarDbEditHostList.jiqi-IP"),align:"center","min-width":"130px"}}),r("el-table-column",{attrs:{prop:"handle",label:e.$t("clusterDefine.caozuo"),align:"center","min-width":"165px"}})],1),r("div",{staticClass:"block",staticStyle:{float:"right"}},[r("el-pagination",{ref:"pagination",attrs:{layout:"total, sizes, prev, pager, next, jumper",total:e.total,"page-sizes":[20,30,40,50,100]},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)}),[],!1,k,"a3c5b118",null,null);function k(e){for(let t in S)this[t]=S[t]}const q={};var C=n({name:"ModifyCluster",inject:["reload"],components:{clusterInfo:v,editDBList:I,editHostList:function(){return x.exports}(),computerRoomConfig:g},data:()=>({activeName:"clusterInfo",dialogWidth:0,isSmallSidebar:1,row:{},modifyShow:!1,tabShow:!0,clusterType:"",clusterName:"",clusterState:"",Permission_repu:!1}),methods:{clusterOffline(){const e=JSON.parse(JSON.stringify(this.$route.query));this.$confirm(this.$t("HAManage.queren-jiang-message")+e.cluster_id+this.$t("HAManage.lixianma"),this.$t("index.ti-shi"),{type:"warning",closeOnClickModal:!1}).then((()=>{const t=l(".component");let r={cluster_id:e.cluster_id};s.offline(r).then((()=>{e.cluster_state=0,this.$router.replace({query:e}),this.refresh(),this.$message.success({showClose:!0,message:this.$t("ModifyCluster.lixian-chenggong"),duration:2e3}),t.close()}),(e=>t.close()))})).catch((()=>{}))},refresh(){this.tabShow=!1,this.$nextTick((()=>this.tabShow=!0))},updateTable:function(){this.modifyShow=!1,this.$emit("refreshTable")},openDialog:function(e){const t=this;this.$router.push({query:{}}),this.$router.push({query:e}),t.loading=!0,0==document.getElementsByClassName("showSidebar").length?(t.isSmallSidebar=1,t.dialogWidth=document.body.clientWidth-60):(t.dialogWidth=document.body.clientWidth-180,t.isSmallSidebar=2),t.row=e,t.modifyShow=!0,this.clusterName=e.cluster_name,this.clusterType=e.cluster_type,this.clusterState=e.cluster_state,this.tabShow=!1,this.$nextTick((()=>this.tabShow=!0)),2===this.clusterType&&(this.activeName="clusterInfo")}},mounted:function(){b.$on("Permission_repu",(e=>{this.Permission_repu=e}))}},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{ref:"queryLog",attrs:{title:e.$t("polarDbModifyCluster.jiqunmingcheng")+e.clusterName+", ID="+e.row.cluster_id,"append-to-body":!0,"custom-class":1==e.isSmallSidebar?"querylog querylogmin":"querylog querylogmax",modal:!1,width:e.dialogWidth+"px",top:"0",visible:e.modifyShow,"close-on-click-modal":!0},on:{close:e.updateTable,"update:visible":function(t){e.modifyShow=t}}},[r("el-row",{staticClass:"warp"},[r("el-col",{staticClass:"warp-breadcrum",attrs:{span:24}},[r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:e.refresh}},[e._v(e._s(e.$t("resourceManagement.shua-xin")))]),"clusterInfo"===e.activeName&&1===e.$route.query.cluster_state?r("div",{staticClass:"warp-breadcrum_words"},[r("span",[e._v(e._s(e.$t("ModifyCluster.lixian-m")))]),r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:e.clusterOffline}},[e._v(e._s(e.$t("dashboard.li-xian")))])],1):e._e()],1),r("el-col",{staticClass:"warp-main",attrs:{span:24}},[[r("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:e.$t("createStreamReplicationCluster.jiqun-xinxi"),name:"clusterInfo"}}),r("el-tab-pane",{attrs:{label:e.$t("polarDbModifyCluster.zhubei-shujuku"),name:"editDBList"}}),e.Permission_repu?e._e():r("el-tab-pane",{attrs:{label:e.$t("polarDbModifyCluster.jifang-peizhi"),name:"computerRoomConfig"}})],1)],e.tabShow?r(e.activeName,{tag:"component",staticClass:"component"}):e._e()],2)],1)],1)],1)}),[],!1,D,"1fc35cce",null,null);function D(e){for(let t in q)this[t]=q[t]}var L=function(){return C.exports}();export{L as default};
